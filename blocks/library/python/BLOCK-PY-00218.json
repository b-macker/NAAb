{
  "code": "extern \"C\" {\n\nvoid BLOCK-PY-00218_execute() {\n    def _generate_nodejs_dockerfile(self, complexity: str) -> str:\n        \"\"\"Generate Node.js optimized Dockerfile\"\"\"\n        if complexity == 'high':\n            return \"\"\"# Multi-stage Node.js Production Dockerfile\n# Stage 1: Build stage\nFROM node:18-alpine AS builder\n\n# Security: Create non-root user\nRUN addgroup -g 1001 -S nodejs\nRUN adduser -S nextjs -u 1001\n\n# Set working directory\nWORKDIR /app\n\n# Copy package files for dependency caching\nCOPY package*.json ./\nCOPY yarn.lock* ./\n\n# Install dependencies with cache mount\nRUN --mount=type=cache,target=/root/.npm \\\n    npm ci --only=production --frozen-lockfile\n\n# Copy source code\nCOPY . .\n\n# Build application\nRUN npm run build\n\n# Stage 2: Production runtime\nFROM node:18-alpine AS runner\n\n# Install security updates\nRUN apk update && apk upgrade && apk add --no-cache \\\n    dumb-init \\\n    curl \\\n    && rm -rf /var/cache/apk/*\n\n# Security: Create non-root user\nRUN addgroup -g 1001 -S nodejs\nRUN adduser -S nextjs -u 1001\n\nWORKDIR /app\n\n# Copy built application from builder stage  \nCOPY --from=builder --chown=nextjs:nodejs /app/dist ./dist\nCOPY --from=builder --chown=nextjs:nodejs /app/node_modules ./node_modules\nCOPY --from=builder --chown=nextjs:nodejs /app/package*.json ./\n\n# Security: Switch to non-root user\nUSER nextjs\n\n# Health check\nHEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \\\n    CMD curl -f http://localhost:3000/health || exit 1\n\n# Expose port\nEXPOSE 3000\n\n# Use dumb-init for proper signal handling\nENTRYPOINT [\"dumb-init\", \"--\"]\nCMD [\"node\", \"dist/index.js\"]\n\n# Metadata\nLABEL maintainer=\"devops@company.com\"\nLABEL version=\"1.0.0\"\nLABEL description=\"Production Node.js application\"\nLABEL org.opencontainers.image.source=\"https://github.com/company/app\"\nLABEL org.opencontainers.image.documentation=\"https://docs.company.com/app\"\nLABEL org.opencontainers.image.licenses=\"MIT\"\n\n# Environment variables\nENV NODE_ENV=production\nENV PORT=3000\"\"\"\n        \n        elif complexity == 'medium':\n            return \"\"\"# Node.js Production Dockerfile\nFROM node:18-alpine\n\n# Install security updates and required packages\nRUN apk update && apk upgrade && apk add --no-cache \\\n    dumb-init \\\n    curl\n\n# Create app directory and user\nWORKDIR /app\nRUN addgroup -g 1001 -S nodejs && \\\n    adduser -S nextjs -u 1001\n\n# Copy package files and install dependencies\nCOPY package*.json ./\nRUN npm ci --only=production && npm cache clean --force\n\n# Copy application code\nCOPY . .\nRUN chown -R nextjs:nodejs /app\n\n# Switch to non-root user\nUSER nextjs\n\n# Health check\nHEALTHCHECK --interval=30s --timeout=3s \\\n    CMD curl -f http://localhost:3000/health || exit 1\n\n# Expose port and start application\nEXPOSE 3000\nENTRYPOINT [\"dumb-init\", \"--\"]\nCMD [\"node\", \"index.js\"]\"\"\"\n        \n        else:  # simple\n            return \"\"\"# Simple Node.js Dockerfile\nFROM node:18-alpine\n\nWORKDIR /app\n\n# Copy package files and install dependencies\nCOPY package*.json ./\nRUN npm install --production\n\n# Copy application code\nCOPY . .\n\n# Expose port\nEXPOSE 3000\n\n# Start application\nCMD [\"node\", \"index.js\"]\"\"\"\n}\n\n} // extern \"C\"\n",
  "id": "BLOCK-PY-00218",
  "language": "python",
  "source_file": "/storage/emulated/0/Download/integrate ideas/Generators/devops_generator.py",
  "source_line": 0,
  "validation_status": "validated"
}
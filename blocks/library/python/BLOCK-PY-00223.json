{
  "code": "extern \"C\" {\n\nvoid BLOCK-PY-00223_execute() {\n    def _generate_web_k8s_deployment(self, complexity: str) -> str:\n        \"\"\"Generate Kubernetes deployment for web application\"\"\"\n        if complexity == 'high':\n            return \"\"\"# Production Kubernetes Deployment for Web Application\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web-app\n  namespace: production\n  labels:\n    app: web-app\n    tier: frontend\n    version: v1.0.0\n  annotations:\n    deployment.kubernetes.io/revision: \"1\"\n    kubernetes.io/change-cause: \"Initial deployment\"\nspec:\n  replicas: 3\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxUnavailable: 1\n      maxSurge: 1\n  selector:\n    matchLabels:\n      app: web-app\n      tier: frontend\n  template:\n    metadata:\n      labels:\n        app: web-app\n        tier: frontend\n        version: v1.0.0\n      annotations:\n        prometheus.io/scrape: \"true\"\n        prometheus.io/port: \"3000\"\n        prometheus.io/path: \"/metrics\"\n    spec:\n      serviceAccountName: web-app-sa\n      securityContext:\n        runAsNonRoot: true\n        runAsUser: 1001\n        fsGroup: 2000\n      containers:\n      - name: web-app\n        image: company/web-app:1.0.0\n        imagePullPolicy: Always\n        ports:\n        - containerPort: 3000\n          name: http\n          protocol: TCP\n        env:\n        - name: NODE_ENV\n          value: \"production\"\n        - name: REACT_APP_API_URL\n          valueFrom:\n            configMapKeyRef:\n              name: web-app-config\n              key: api-url\n        - name: SENTRY_DSN\n          valueFrom:\n            secretKeyRef:\n              name: web-app-secrets\n              key: sentry-dsn\n        resources:\n          requests:\n            memory: \"128Mi\"\n            cpu: \"100m\"\n          limits:\n            memory: \"512Mi\"  \n            cpu: \"500m\"\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: http\n          initialDelaySeconds: 30\n          periodSeconds: 10\n          timeoutSeconds: 5\n          successThreshold: 1\n          failureThreshold: 3\n        readinessProbe:\n          httpGet:\n            path: /ready\n            port: http\n          initialDelaySeconds: 5\n          periodSeconds: 5\n          timeoutSeconds: 3\n          successThreshold: 1\n          failureThreshold: 3\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - ALL\n        volumeMounts:\n        - name: tmp\n          mountPath: /tmp\n        - name: cache\n          mountPath: /app/.cache\n      volumes:\n      - name: tmp\n        emptyDir: {}\n      - name: cache\n        emptyDir: {}\n      affinity:\n        podAntiAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n          - weight: 100\n            podAffinityTerm:\n              labelSelector:\n                matchExpressions:\n                - key: app\n                  operator: In\n                  values:\n                  - web-app\n              topologyKey: kubernetes.io/hostname\n      tolerations:\n      - key: \"node.kubernetes.io/not-ready\"\n        operator: \"Exists\"\n        effect: \"NoExecute\"\n        tolerationSeconds: 300\n      - key: \"node.kubernetes.io/unreachable\"\n        operator: \"Exists\"  \n        effect: \"NoExecute\"\n        tolerationSeconds: 300\n\n---\n# Service for Web Application\napiVersion: v1\nkind: Service\nmetadata:\n  name: web-app-service\n  namespace: production\n  labels:\n    app: web-app\n    tier: frontend\nspec:\n  type: ClusterIP\n  ports:\n  - port: 80\n    targetPort: http\n    protocol: TCP\n    name: http\n  selector:\n    app: web-app\n    tier: frontend\n\n---\n# ConfigMap for Web Application\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: web-app-config\n  namespace: production\ndata:\n  api-url: \"https://api.company.com\"\n  log-level: \"info\"\n  feature-flags: |\n    {\n      \"newUI\": true,\n      \"analytics\": true,\n      \"betaFeatures\": false\n    }\n\n---\n# Secret for Web Application  \napiVersion: v1\nkind: Secret\nmetadata:\n  name: web-app-secrets\n  namespace: production\ntype: Opaque\nstringData:\n  sentry-dsn: \"https://your-sentry-dsn@sentry.io/project\"\n  google-analytics: \"GA_TRACKING_ID\"\n\n---\n# Horizontal Pod Autoscaler\napiVersion: autoscaling/v2\nkind: HorizontalPodAutoscaler\nmetadata:\n  name: web-app-hpa\n  namespace: production\nspec:\n  scaleTargetRef:\n    apiVersion: apps/v1\n    kind: Deployment\n    name: web-app\n  minReplicas: 3\n  maxReplicas: 10\n  metrics:\n  - type: Resource\n    resource:\n      name: cpu\n      target:\n        type: Utilization\n        averageUtilization: 70\n  - type: Resource\n    resource:\n      name: memory\n      target:\n        type: Utilization\n        averageUtilization: 80\n  behavior:\n    scaleDown:\n      stabilizationWindowSeconds: 300\n      policies:\n      - type: Percent\n        value: 10\n        periodSeconds: 60\n    scaleUp:\n      stabilizationWindowSeconds: 0\n      policies:\n      - type: Percent\n        value: 100\n        periodSeconds: 15\n      - type: Pods\n        value: 4\n        periodSeconds: 15\n      selectPolicy: Max\n\n---\n# Network Policy\napiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n  name: web-app-netpol\n  namespace: production\nspec:\n  podSelector:\n    matchLabels:\n      app: web-app\n  policyTypes:\n  - Ingress\n  - Egress\n  ingress:\n  - from:\n    - namespaceSelector:\n        matchLabels:\n          name: ingress-nginx\n    ports:\n    - protocol: TCP\n      port: 3000\n  egress:\n  - to:\n    - namespaceSelector:\n        matchLabels:\n          name: production\n    ports:\n    - protocol: TCP\n      port: 8000  # API server\n  - to: []  # Allow DNS\n    ports:\n    - protocol: UDP\n      port: 53\"\"\"\n        \n        elif complexity == 'medium':\n            return \"\"\"# Kubernetes Deployment for Web Application\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web-app\n  labels:\n    app: web-app\nspec:\n  replicas: 2\n  selector:\n    matchLabels:\n      app: web-app\n  template:\n    metadata:\n      labels:\n        app: web-app\n    spec:\n      containers:\n      - name: web-app\n        image: company/web-app:latest\n        ports:\n        - containerPort: 3000\n        env:\n        - name: NODE_ENV\n          value: \"production\"\n        - name: API_URL\n          valueFrom:\n            configMapKeyRef:\n              name: app-config\n              key: api-url\n        resources:\n          requests:\n            memory: \"64Mi\"\n            cpu: \"50m\"\n          limits:\n            memory: \"256Mi\"\n            cpu: \"200m\"\n        livenessProbe:\n          httpGet:\n            path: /health\n            port: 3000\n          initialDelaySeconds: 30\n          periodSeconds: 10\n        readinessProbe:\n          httpGet:\n            path: /health\n            port: 3000\n          initialDelaySeconds: 5\n          periodSeconds: 5\n\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: web-app-service\nspec:\n  selector:\n    app: web-app\n  ports:\n  - port: 80\n    targetPort: 3000\n  type: ClusterIP\n\n---\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: app-config\ndata:\n  api-url: \"http://api-service:8000\"\n  log-level: \"info\" \"\"\"\n        \n        else:  # simple\n            return \"\"\"# Simple Kubernetes Deployment\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: web-app\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: web-app\n  template:\n    metadata:\n      labels:\n        app: web-app\n    spec:\n      containers:\n      - name: web-app\n        image: nginx:alpine\n        ports:\n        - containerPort: 80\n\n---\napiVersion: v1  \nkind: Service\nmetadata:\n  name: web-app-service\nspec:\n  selector:\n    app: web-app\n  ports:\n  - port: 80\n    targetPort: 80\n  type: LoadBalancer\"\"\"\n}\n\n} // extern \"C\"\n",
  "id": "BLOCK-PY-00223",
  "language": "python",
  "source_file": "/storage/emulated/0/Download/integrate ideas/Generators/devops_generator.py",
  "source_line": 0,
  "validation_status": "validated"
}
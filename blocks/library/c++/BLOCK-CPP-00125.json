{
  "code": "{\nnamespace details {\n\n// padding information.\nstruct padding_info {\n    enum class pad_side { left, right, center };\n\n    padding_info() = default;\n    padding_info(size_t width, padding_info::pad_side side, bool truncate)\n        : width_(width),\n          side_(side),\n          truncate_(truncate),\n          enabled_(true) {}\n\n    bool enabled() const { return enabled_; }\n    size_t width_ = 0;\n    pad_side side_ = pad_side::left;\n    bool truncate_ = false;\n    bool enabled_ = false;\n};\n\nclass SPDLOG_API flag_formatter {\npublic:\n    explicit flag_formatter(padding_info padinfo)\n        : padinfo_(padinfo) {}\n    flag_formatter() = default;\n    virtual ~flag_formatter() = default;\n    virtual void format(const details::log_msg &msg,\n                        const std::tm &tm_time,\n                        memory_buf_t &dest) = 0;\n\nprotected:\n    padding_info padinfo_;\n};\n\n}  // namespace details\n\nclass SPDLOG_API custom_flag_formatter : public details::flag_formatter {\npublic:\n    virtual std::unique_ptr<custom_flag_formatter> clone() const = 0;\n\n    void set_padding_info(const details::padding_info &padding) {\n        flag_formatter::padinfo_ = padding;\n    }\n};\n\nclass SPDLOG_API pattern_formatter final : public formatter {\npublic:\n    using custom_flags = std::unordered_map<char, std::unique_ptr<custom_flag_formatter>>;\n\n    explicit pattern_formatter(std::string pattern,\n                               pattern_time_type time_type = pattern_time_type::local,\n                               std::string eol = spdlog::details::os::default_eol,\n                               custom_flags custom_user_flags = custom_flags());\n\n    // use default pattern is not given\n    explicit pattern_formatter(pattern_time_type time_type = pattern_time_type::local,\n                               std::string eol = spdlog::details::os::default_eol);\n\n    pattern_formatter(const pattern_formatter &other) = delete;\n    pattern_formatter &operator=(const pattern_formatter &other) = delete;\n\n    std::unique_ptr<formatter> clone() const override;\n    void format(const details::log_msg &msg, memory_buf_t &dest) override;\n\n    template <typename T, typename... Args>\n    pattern_formatter &add_flag(char flag, Args &&...args) {\n        custom_handlers_[flag] = details::make_unique<T>(std::forward<Args>(args)...);\n        return *this;\n    }\n    void set_pattern(std::string pattern);\n    void need_localtime(bool need = true);\n\nprivate:\n    std::string pattern_;\n    std::string eol_;\n    pattern_time_type pattern_time_type_;\n    bool need_localtime_;\n    std::tm cached_tm_;\n    std::chrono::seconds last_log_secs_;\n    std::vector<std::unique_ptr<details::flag_formatter>> formatters_;\n    custom_flags custom_handlers_;\n\n    std::tm get_time_(const details::log_msg &msg);\n    template <typename Padder>\n    void handle_flag_(char flag, details::padding_info padding);\n\n    // Extract given pad spec (e.g. %8X)\n    // Advance the given it pass the end of the padding spec found (if any)\n    // Return padding.\n    static details::padding_info handle_padspec_(std::string::const_iterator &it,\n                                                 std::string::const_iterator end);\n\n    void compile_pattern_(const std::string &pattern);\n};\n}",
  "id": "BLOCK-CPP-00125",
  "language": "c++",
  "source_file": "/storage/emulated/0/Download/cpp_codebases/spdlog/include/spdlog/pattern_formatter.h",
  "source_line": 19,
  "validation_status": "validated"
}
{
  "code": "#include \"absl/strings/internal/cord_rep_btree_reader.h\"\n#include <cassert>\n#include \"absl/base/config.h\"\n#include \"absl/strings/internal/cord_data_edge.h\"\n#include \"absl/strings/internal/cord_internal.h\"\n#include \"absl/strings/internal/cord_rep_btree.h\"\n#include \"absl/strings/internal/cord_rep_btree_navigator.h\"\n#include \"absl/strings/internal/cord_rep_flat.h\"\n\nusing namespace absl;\n\nextern \"C\" {\n\nvoid BLOCK-CPP-02898_execute() {\n    {\nABSL_NAMESPACE_BEGIN\nnamespace cord_internal {\n\nabsl::string_view CordRepBtreeReader::Read(size_t n, size_t chunk_size,\n                                           CordRep*& tree) {\n  assert(chunk_size <= navigator_.Current()->length);\n\n  // If chunk_size is non-zero, we need to start inside last returned edge.\n  // Else we start reading at the next data edge of the tree.\n  CordRep* edge = chunk_size ? navigator_.Current() : navigator_.Next();\n  const size_t offset = chunk_size ? edge->length - chunk_size : 0;\n\n  // Read the sub tree and verify we got what we wanted.\n  ReadResult result = navigator_.Read(offset, n);\n  tree = result.tree;\n\n  // If the data returned in `tree` was covered entirely by `chunk_size`, i.e.,\n  // read from the 'previous' edge, we did not consume any additional data, and\n  // can directly return the substring into the current data edge as the next\n  // chunk. We can easily establish from the above code that `navigator_.Next()`\n  // has not been called as that requires `chunk_size` to be zero.\n  if (n < chunk_size) return EdgeData(edge).substr(result.n);\n\n  // The amount of data taken from the last edge is `chunk_size` and `result.n`\n  // contains the offset into the current edge trailing the read data (which can\n  // be 0). As the call to `navigator_.Read()` could have consumed all remaining\n  // data, calling `navigator_.Current()` is not safe before checking if we\n  // already consumed all remaining data.\n  const size_t consumed_by_read = n - chunk_size - result.n;\n  if (consumed_by_read >= remaining_) {\n    remaining_ = 0;\n    return {};\n  }\n\n  // We did not read all data, return remaining data from current edge.\n  edge = navigator_.Current();\n  remaining_ -= consumed_by_read + edge->length;\n  return EdgeData(edge).substr(result.n);\n}\n\n}  // namespace cord_internal\nABSL_NAMESPACE_END\n}\n}\n\n} // extern \"C\"\n",
  "id": "BLOCK-CPP-02898",
  "language": "c++",
  "source_file": "/storage/emulated/0/Download/cpp_codebases/abseil/absl/strings/internal/cord_rep_btree_reader.cc",
  "source_line": 26,
  "validation_status": "validated"
}
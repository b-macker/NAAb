{
  "code": "#include \"absl/random/internal/randen_slow.h\"\n#include <cstddef>\n#include <cstdint>\n#include <cstring>\n#include \"absl/base/attributes.h\"\n#include \"absl/base/internal/endian.h\"\n#include \"absl/numeric/int128.h\"\n#include \"absl/random/internal/platform.h\"\n#include \"absl/random/internal/randen_traits.h\"\n\nusing namespace absl;\n\nextern \"C\" {\n\nvoid BLOCK-CPP-02836_execute() {\n    {\nABSL_NAMESPACE_BEGIN\nnamespace random_internal {\n\nconst void* RandenSlow::GetKeys() {\n  // Round keys for one AES per Feistel round and branch.\n  // The canonical implementation uses first digits of Pi.\n#ifdef ABSL_IS_LITTLE_ENDIAN\n  return kRandenRoundKeys;\n#else\n  return kRandenRoundKeysBE;\n#endif\n}\n\nvoid RandenSlow::Absorb(const void* seed_void, void* state_void) {\n  auto* state =\n      reinterpret_cast<uint64_t * ABSL_RANDOM_INTERNAL_RESTRICT>(state_void);\n  const auto* seed =\n      reinterpret_cast<const uint64_t * ABSL_RANDOM_INTERNAL_RESTRICT>(\n          seed_void);\n\n  constexpr size_t kCapacityBlocks =\n      RandenTraits::kCapacityBytes / sizeof(uint64_t);\n  static_assert(\n      kCapacityBlocks * sizeof(uint64_t) == RandenTraits::kCapacityBytes,\n      \"Not i*V\");\n\n  for (size_t i = kCapacityBlocks;\n       i < RandenTraits::kStateBytes / sizeof(uint64_t); ++i) {\n    state[i] ^= seed[i - kCapacityBlocks];\n  }\n}\n\nvoid RandenSlow::Generate(const void* keys_void, void* state_void) {\n  static_assert(RandenTraits::kCapacityBytes == sizeof(absl::uint128),\n                \"Capacity mismatch\");\n\n  auto* state = reinterpret_cast<absl::uint128*>(state_void);\n  const auto* keys = reinterpret_cast<const absl::uint128*>(keys_void);\n\n  const absl::uint128 prev_inner = state[0];\n\n  SwapEndian(state);\n\n  Permute(state, keys);\n\n  SwapEndian(state);\n\n  // Ensure backtracking resistance.\n  *state ^= prev_inner;\n}\n\n}  // namespace random_internal\nABSL_NAMESPACE_END\n}\n}\n\n} // extern \"C\"\n",
  "id": "BLOCK-CPP-02836",
  "language": "c++",
  "source_file": "/storage/emulated/0/Download/cpp_codebases/abseil/absl/random/internal/randen_slow.cc",
  "source_line": 417,
  "validation_status": "validated"
}
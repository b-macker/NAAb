{
  "code": "{\n  const char kEntropyFile[] = \"/dev/urandom\";\n\n  auto buffer = reinterpret_cast<uint8_t*>(values.data());\n  size_t buffer_size = sizeof(uint32_t) * values.size();\n\n  int dev_urandom = open(kEntropyFile, O_RDONLY);\n  bool success = (-1 != dev_urandom);\n  if (!success) {\n    return false;\n  }\n\n  while (success && buffer_size > 0) {\n    ssize_t bytes_read = read(dev_urandom, buffer, buffer_size);\n    int read_error = errno;\n    success = (bytes_read > 0);\n    if (success) {\n      buffer += bytes_read;\n      buffer_size -= static_cast<size_t>(bytes_read);\n    } else if (bytes_read == -1 && read_error == EINTR) {\n      success = true;  // Need to try again.\n    }\n  }\n  close(dev_urandom);\n  return success;\n}",
  "id": "BLOCK-CPP-02842",
  "language": "c++",
  "source_file": "/storage/emulated/0/Download/cpp_codebases/abseil/absl/random/internal/seed_material.cc",
  "source_line": 163,
  "validation_status": "validated"
}
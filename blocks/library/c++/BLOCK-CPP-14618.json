{
  "code": "#include \"clang/AST/BaseSubobject.h\"\n#include \"clang/AST/CharUnits.h\"\n#include \"clang/Basic/LLVM.h\"\n#include \"llvm/ADT/DenseMap.h\"\n#include \"llvm/ADT/PointerIntPair.h\"\n#include \"llvm/ADT/SmallPtrSet.h\"\n#include \"llvm/ADT/SmallVector.h\"\n#include <cstdint>\n\nusing namespace clang;\n\nextern \"C\" {\n\nvoid BLOCK-CPP-14618_execute() {\n    {\n\nclass ASTContext;\nclass ASTRecordLayout;\nclass CXXRecordDecl;\n\nclass VTTVTable {\n  llvm::PointerIntPair<const CXXRecordDecl *, 1, bool> BaseAndIsVirtual;\n  CharUnits BaseOffset;\n\npublic:\n  VTTVTable() = default;\n  VTTVTable(const CXXRecordDecl *Base, CharUnits BaseOffset, bool BaseIsVirtual)\n      : BaseAndIsVirtual(Base, BaseIsVirtual), BaseOffset(BaseOffset) {}\n  VTTVTable(BaseSubobject Base, bool BaseIsVirtual)\n      : BaseAndIsVirtual(Base.getBase(), BaseIsVirtual),\n        BaseOffset(Base.getBaseOffset()) {}\n\n  const CXXRecordDecl *getBase() const {\n    return BaseAndIsVirtual.getPointer();\n  }\n\n  CharUnits getBaseOffset() const {\n    return BaseOffset;\n  }\n\n  bool isVirtual() const {\n    return BaseAndIsVirtual.getInt();\n  }\n\n  BaseSubobject getBaseSubobject() const {\n    return BaseSubobject(getBase(), getBaseOffset());\n  }\n};\n\nstruct VTTComponent {\n  uint64_t VTableIndex;\n  BaseSubobject VTableBase;\n\n  VTTComponent() = default;\n  VTTComponent(uint64_t VTableIndex, BaseSubobject VTableBase)\n     : VTableIndex(VTableIndex), VTableBase(VTableBase) {}\n};\n\n/// Class for building VTT layout information.\nclass VTTBuilder {\n  ASTContext &Ctx;\n\n  /// The most derived class for which we're building this vtable.\n  const CXXRecordDecl *MostDerivedClass;\n\n  using VTTVTablesVectorTy = SmallVector<VTTVTable, 64>;\n\n  /// The VTT vtables.\n  VTTVTablesVectorTy VTTVTables;\n\n  using VTTComponentsVectorTy = SmallVector<VTTComponent, 64>;\n\n  /// The VTT components.\n  VTTComponentsVectorTy VTTComponents;\n\n  /// The AST record layout of the most derived class.\n  const ASTRecordLayout &MostDerivedClassLayout;\n\n  using VisitedVirtualBasesSetTy = llvm::SmallPtrSet<const CXXRecordDecl *, 4>;\n\n  using AddressPointsMapTy = llvm::DenseMap<BaseSubobject, uint64_t>;\n\n  /// The sub-VTT indices for the bases of the most derived class.\n  llvm::DenseMap<BaseSubobject, uint64_t> SubVTTIndicies;\n\n  /// The secondary virtual pointer indices of all subobjects of\n  /// the most derived class.\n  llvm::DenseMap<BaseSubobject, uint64_t> SecondaryVirtualPointerIndices;\n\n  /// Whether the VTT builder should generate LLVM IR for the VTT.\n  bool GenerateDefinition;\n\n  /// Add a vtable pointer to the VTT currently being built.\n  void AddVTablePointer(BaseSubobject Base, uint64_t VTableIndex,\n                        const CXXRecordDecl *VTableClass);\n\n  /// Lay out the secondary VTTs of the given base subobject.\n  void LayoutSecondaryVTTs(BaseSubobject Base);\n\n  /// Lay out the secondary virtual pointers for the given base\n  /// subobject.\n  ///\n  /// \\param BaseIsMorallyVirtual whether the base subobject is a virtual base\n  /// or a direct or indirect base of a virtual base.\n  void LayoutSecondaryVirtualPointers(BaseSubobject Base,\n                                      bool BaseIsMorallyVirtual,\n                                      uint64_t VTableIndex,\n                                      const CXXRecordDecl *VTableClass,\n                                      VisitedVirtualBasesSetTy &VBases);\n\n  /// Lay out the secondary virtual pointers for the given base\n  /// subobject.\n  void LayoutSecondaryVirtualPointers(BaseSubobject Base,\n                                      uint64_t VTableIndex);\n\n  /// Lay out the VTTs for the virtual base classes of the given\n  /// record declaration.\n  void LayoutVirtualVTTs(const CXXRecordDecl *RD,\n                         VisitedVirtualBasesSetTy &VBases);\n\n  /// Lay out the VTT for the given subobject, including any\n  /// secondary VTTs, secondary virtual pointers and virtual VTTs.\n  void LayoutVTT(BaseSubobject Base, bool BaseIsVirtual);\n\npublic:\n  VTTBuilder(ASTContext &Ctx, const CXXRecordDecl *MostDerivedClass,\n             bool GenerateDefinition);\n\n  // Returns a reference to the VTT components.\n  const VTTComponentsVectorTy &getVTTComponents() const {\n    return VTTComponents;\n  }\n\n  // Returns a reference to the VTT vtables.\n  const VTTVTablesVectorTy &getVTTVTables() const {\n    return VTTVTables;\n  }\n\n  /// Returns a reference to the sub-VTT indices.\n  const llvm::DenseMap<BaseSubobject, uint64_t> &getSubVTTIndicies() const {\n    return SubVTTIndicies;\n  }\n\n  /// Returns a reference to the secondary virtual pointer indices.\n  const llvm::DenseMap<BaseSubobject, uint64_t> &\n  getSecondaryVirtualPointerIndices() const {\n    return SecondaryVirtualPointerIndices;\n  }\n};\n\n}\n}\n\n} // extern \"C\"\n",
  "id": "BLOCK-CPP-14618",
  "language": "c++",
  "source_file": "/storage/emulated/0/Download/cpp_codebases/llvm/clang/include/clang/AST/VTTBuilder.h",
  "source_line": 26,
  "validation_status": "validated"
}
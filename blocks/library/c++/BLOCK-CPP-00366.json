{
  "code": "#include <array>\n#include <memory>\n#include <mutex>\n#include <spdlog/details/console_globals.h>\n#include <spdlog/details/null_mutex.h>\n#include <spdlog/sinks/sink.h>\n#include <string>\n\nusing namespace spdlog;\n\nextern \"C\" {\n\nvoid BLOCK-CPP-00366_execute() {\n    {\nnamespace sinks {\n\n/**\n * This sink prefixes the output with an ANSI escape sequence color code\n * depending on the severity\n * of the message.\n * If no color terminal detected, omit the escape codes.\n */\n\ntemplate <typename ConsoleMutex>\nclass ansicolor_sink : public sink {\npublic:\n    using mutex_t = typename ConsoleMutex::mutex_t;\n    ansicolor_sink(FILE *target_file, color_mode mode);\n    ~ansicolor_sink() override = default;\n\n    ansicolor_sink(const ansicolor_sink &other) = delete;\n    ansicolor_sink(ansicolor_sink &&other) = delete;\n\n    ansicolor_sink &operator=(const ansicolor_sink &other) = delete;\n    ansicolor_sink &operator=(ansicolor_sink &&other) = delete;\n\n    void set_color(level::level_enum color_level, string_view_t color);\n    void set_color_mode(color_mode mode);\n    bool should_color();\n\n    void log(const details::log_msg &msg) override;\n    void flush() override;\n    void set_pattern(const std::string &pattern) final;\n    void set_formatter(std::unique_ptr<spdlog::formatter> sink_formatter) override;\n\n    // Formatting codes\n    const string_view_t reset = \"\\033[m\";\n    const string_view_t bold = \"\\033[1m\";\n    const string_view_t dark = \"\\033[2m\";\n    const string_view_t underline = \"\\033[4m\";\n    const string_view_t blink = \"\\033[5m\";\n    const string_view_t reverse = \"\\033[7m\";\n    const string_view_t concealed = \"\\033[8m\";\n    const string_view_t clear_line = \"\\033[K\";\n\n    // Foreground colors\n    const string_view_t black = \"\\033[30m\";\n    const string_view_t red = \"\\033[31m\";\n    const string_view_t green = \"\\033[32m\";\n    const string_view_t yellow = \"\\033[33m\";\n    const string_view_t blue = \"\\033[34m\";\n    const string_view_t magenta = \"\\033[35m\";\n    const string_view_t cyan = \"\\033[36m\";\n    const string_view_t white = \"\\033[37m\";\n\n    /// Background colors\n    const string_view_t on_black = \"\\033[40m\";\n    const string_view_t on_red = \"\\033[41m\";\n    const string_view_t on_green = \"\\033[42m\";\n    const string_view_t on_yellow = \"\\033[43m\";\n    const string_view_t on_blue = \"\\033[44m\";\n    const string_view_t on_magenta = \"\\033[45m\";\n    const string_view_t on_cyan = \"\\033[46m\";\n    const string_view_t on_white = \"\\033[47m\";\n\n    /// Bold colors\n    const string_view_t yellow_bold = \"\\033[33m\\033[1m\";\n    const string_view_t red_bold = \"\\033[31m\\033[1m\";\n    const string_view_t bold_on_red = \"\\033[1m\\033[41m\";\n\nprivate:\n    FILE *target_file_;\n    mutex_t &mutex_;\n    bool should_do_colors_;\n    std::unique_ptr<spdlog::formatter> formatter_;\n    std::array<std::string, level::n_levels> colors_;\n    void print_ccode_(const string_view_t &color_code);\n    void print_range_(const memory_buf_t &formatted, size_t start, size_t end);\n    static std::string to_string_(const string_view_t &sv);\n};\n\ntemplate <typename ConsoleMutex>\nclass ansicolor_stdout_sink : public ansicolor_sink<ConsoleMutex> {\npublic:\n    explicit ansicolor_stdout_sink(color_mode mode = color_mode::automatic);\n};\n\ntemplate <typename ConsoleMutex>\nclass ansicolor_stderr_sink : public ansicolor_sink<ConsoleMutex> {\npublic:\n    explicit ansicolor_stderr_sink(color_mode mode = color_mode::automatic);\n};\n\nusing ansicolor_stdout_sink_mt = ansicolor_stdout_sink<details::console_mutex>;\nusing ansicolor_stdout_sink_st = ansicolor_stdout_sink<details::console_nullmutex>;\n\nusing ansicolor_stderr_sink_mt = ansicolor_stderr_sink<details::console_mutex>;\nusing ansicolor_stderr_sink_st = ansicolor_stderr_sink<details::console_nullmutex>;\n\n}  // namespace sinks\n}\n}\n\n} // extern \"C\"\n",
  "id": "BLOCK-CPP-00366",
  "language": "c++",
  "source_file": "/storage/emulated/0/Download/cpp_codebases/spdlog/include/spdlog/sinks/ansicolor_sink.h",
  "source_line": 14,
  "validation_status": "validated"
}
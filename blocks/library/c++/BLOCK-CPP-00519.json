{
  "code": "#include <spdlog/common.h>\n#include <spdlog/details/console_globals.h>\n#include <spdlog/details/null_mutex.h>\n#include <spdlog/sinks/sink.h>\n#include <array>\n#include <cstdint>\n#include <memory>\n#include <mutex>\n#include <string>\n\nusing namespace spdlog;\nusing namespace sinks;\n\nextern \"C\" {\n\nvoid BLOCK-CPP-00519_execute() {\n    {\n/*\n * Windows color console sink. Uses WriteConsoleA to write to the console with\n * colors\n */\ntemplate <typename ConsoleMutex>\nclass wincolor_sink : public sink {\npublic:\n    wincolor_sink(void *out_handle, color_mode mode);\n    ~wincolor_sink() override;\n\n    wincolor_sink(const wincolor_sink &other) = delete;\n    wincolor_sink &operator=(const wincolor_sink &other) = delete;\n\n    // change the color for the given level\n    void set_color(level::level_enum level, std::uint16_t color);\n    void log(const details::log_msg &msg) final override;\n    void flush() final override;\n    void set_pattern(const std::string &pattern) override final;\n    void set_formatter(std::unique_ptr<spdlog::formatter> sink_formatter) override final;\n    void set_color_mode(color_mode mode);\n\nprotected:\n    using mutex_t = typename ConsoleMutex::mutex_t;\n    void *out_handle_;\n    mutex_t &mutex_;\n    bool should_do_colors_;\n    std::unique_ptr<spdlog::formatter> formatter_;\n    std::array<std::uint16_t, level::n_levels> colors_;\n\n    // set foreground color and return the orig console attributes (for resetting later)\n    std::uint16_t set_foreground_color_(std::uint16_t attribs);\n\n    // print a range of formatted message to console\n    void print_range_(const memory_buf_t &formatted, size_t start, size_t end);\n\n    // in case we are redirected to file (not in console mode)\n    void write_to_file_(const memory_buf_t &formatted);\n\n    void set_color_mode_impl(color_mode mode);\n};\n\ntemplate <typename ConsoleMutex>\nclass wincolor_stdout_sink : public wincolor_sink<ConsoleMutex> {\npublic:\n    explicit wincolor_stdout_sink(color_mode mode = color_mode::automatic);\n};\n\ntemplate <typename ConsoleMutex>\nclass wincolor_stderr_sink : public wincolor_sink<ConsoleMutex> {\npublic:\n    explicit wincolor_stderr_sink(color_mode mode = color_mode::automatic);\n};\n\nusing wincolor_stdout_sink_mt = wincolor_stdout_sink<details::console_mutex>;\nusing wincolor_stdout_sink_st = wincolor_stdout_sink<details::console_nullmutex>;\n\nusing wincolor_stderr_sink_mt = wincolor_stderr_sink<details::console_mutex>;\nusing wincolor_stderr_sink_st = wincolor_stderr_sink<details::console_nullmutex>;\n}\n}\n\n} // extern \"C\"\n",
  "id": "BLOCK-CPP-00519",
  "language": "c++",
  "source_file": "/storage/emulated/0/Download/cpp_codebases/spdlog/include/spdlog/sinks/wincolor_sink.h",
  "source_line": 18,
  "validation_status": "validated"
}
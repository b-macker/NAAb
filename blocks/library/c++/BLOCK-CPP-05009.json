{
  "code": "{\n\n// Returns the number of probes required to lookup `key`.  Returns 0 for a\n// search with no collisions.  Higher values mean more hash collisions occurred;\n// however, the exact meaning of this number varies according to the container\n// type.\ntemplate <typename C>\nsize_t GetHashtableDebugNumProbes(\n    const C& c, const typename C::key_type& key) {\n  return absl::container_internal::hashtable_debug_internal::\n      HashtableDebugAccess<C>::GetNumProbes(c, key);\n}\n\n// Gets a histogram of the number of probes for each elements in the container.\n// The sum of all the values in the vector is equal to container.size().\ntemplate <typename C>\nstd::vector<size_t> GetHashtableDebugNumProbesHistogram(const C& container) {\n  std::vector<size_t> v;\n  for (auto it = container.begin(); it != container.end(); ++it) {\n    size_t num_probes = GetHashtableDebugNumProbes(\n        container,\n        absl::container_internal::hashtable_debug_internal::GetKey<C>(*it, 0));\n    v.resize((std::max)(v.size(), num_probes + 1));\n    v[num_probes]++;\n  }\n  return v;\n}\n\nstruct HashtableDebugProbeSummary {\n  size_t total_elements;\n  size_t total_num_probes;\n  double mean;\n};\n\n// Gets a summary of the probe count distribution for the elements in the\n// container.\ntemplate <typename C>\nHashtableDebugProbeSummary GetHashtableDebugProbeSummary(const C& container) {\n  auto probes = GetHashtableDebugNumProbesHistogram(container);\n  HashtableDebugProbeSummary summary = {};\n  for (size_t i = 0; i < probes.size(); ++i) {\n    summary.total_elements += probes[i];\n    summary.total_num_probes += probes[i] * i;\n  }\n  summary.mean = 1.0 * summary.total_num_probes / summary.total_elements;\n  return summary;\n}\n\n// Returns the number of bytes requested from the allocator by the container\n// and not freed.\ntemplate <typename C>\nsize_t AllocatedByteSize(const C& c) {\n  return absl::container_internal::hashtable_debug_internal::\n      HashtableDebugAccess<C>::AllocatedByteSize(c);\n}\n\n}",
  "id": "BLOCK-CPP-05009",
  "language": "c++",
  "source_file": "/storage/emulated/0/Download/cpp_codebases/abseil/absl/container/internal/hashtable_debug.h",
  "source_line": 42,
  "validation_status": "validated"
}
{
  "code": "#include \"absl/debugging/internal/demangle.h\"\n#include <cstdint>\n#include <cstdio>\n#include <cstdlib>\n#include <limits>\n#include <string>\n#include \"absl/base/config.h\"\n#include <cxxabi.h>\n\nusing namespace absl;\nusing namespace debugging_internal;\n\nextern \"C\" {\n\nvoid BLOCK-CPP-02588_execute() {\n    {\n public:\n  explicit ComplexityGuard(State *state) : state_(state) {\n    ++state->recursion_depth;\n    ++state->steps;\n  }\n  ~ComplexityGuard() { --state_->recursion_depth; }\n\n  // 256 levels of recursion seems like a reasonable upper limit on depth.\n  // 128 is not enough to demagle synthetic tests from demangle_unittest.txt:\n  // \"_ZaaZZZZ...\" and \"_ZaaZcvZcvZ...\"\n  static constexpr int kRecursionDepthLimit = 256;\n\n  // We're trying to pick a charitable upper-limit on how many parse steps are\n  // necessary to handle something that a human could actually make use of.\n  // This is mostly in place as a bound on how much work we'll do if we are\n  // asked to demangle an mangled name from an untrusted source, so it should be\n  // much larger than the largest expected symbol, but much smaller than the\n  // amount of work we can do in, e.g., a second.\n  //\n  // Some real-world symbols from an arbitrary binary started failing between\n  // 2^12 and 2^13, so we multiply the latter by an extra factor of 16 to set\n  // the limit.\n  //\n  // Spending one second on 2^17 parse steps would require each step to take\n  // 7.6us, or ~30000 clock cycles, so it's safe to say this can be done in\n  // under a second.\n  static constexpr int kParseStepsLimit = 1 << 17;\n\n  bool IsTooComplex() const {\n    return state_->recursion_depth > kRecursionDepthLimit ||\n           state_->steps > kParseStepsLimit;\n  }\n\n private:\n  State *state_;\n}\n}\n\n} // extern \"C\"\n",
  "id": "BLOCK-CPP-02588",
  "language": "c++",
  "source_file": "/storage/emulated/0/Download/cpp_codebases/abseil/absl/debugging/internal/demangle.cc",
  "source_line": 195,
  "validation_status": "validated"
}
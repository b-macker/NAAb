{
  "code": "{\n\nclass Commit;\nclass EditsReceiver;\n\nclass EditedSource {\n  const SourceManager &SourceMgr;\n  const LangOptions &LangOpts;\n  const PPConditionalDirectiveRecord *PPRec;\n\n  struct FileEdit {\n    StringRef Text;\n    unsigned RemoveLen = 0;\n\n    FileEdit() = default;\n  };\n\n  using FileEditsTy = std::map<FileOffset, FileEdit>;\n\n  FileEditsTy FileEdits;\n\n  struct MacroArgUse {\n    IdentifierInfo *Identifier;\n    SourceLocation ImmediateExpansionLoc;\n\n    // Location of argument use inside the top-level macro\n    SourceLocation UseLoc;\n\n    bool operator==(const MacroArgUse &Other) const {\n      return std::tie(Identifier, ImmediateExpansionLoc, UseLoc) ==\n             std::tie(Other.Identifier, Other.ImmediateExpansionLoc,\n                      Other.UseLoc);\n    }\n  };\n\n  llvm::DenseMap<SourceLocation, SmallVector<MacroArgUse, 2>> ExpansionToArgMap;\n  SmallVector<std::pair<SourceLocation, MacroArgUse>, 2>\n    CurrCommitMacroArgExps;\n\n  IdentifierTable IdentTable;\n  llvm::BumpPtrAllocator StrAlloc;\n\npublic:\n  EditedSource(const SourceManager &SM, const LangOptions &LangOpts,\n               const PPConditionalDirectiveRecord *PPRec = nullptr)\n      : SourceMgr(SM), LangOpts(LangOpts), PPRec(PPRec), IdentTable(LangOpts) {}\n\n  const SourceManager &getSourceManager() const { return SourceMgr; }\n  const LangOptions &getLangOpts() const { return LangOpts; }\n\n  const PPConditionalDirectiveRecord *getPPCondDirectiveRecord() const {\n    return PPRec;\n  }\n\n  bool canInsertInOffset(SourceLocation OrigLoc, FileOffset Offs);\n\n  bool commit(const Commit &commit);\n\n  void applyRewrites(EditsReceiver &receiver, bool adjustRemovals = true);\n  void clearRewrites();\n\n  StringRef copyString(StringRef str) { return str.copy(StrAlloc); }\n  StringRef copyString(const Twine &twine);\n\nprivate:\n  bool commitInsert(SourceLocation OrigLoc, FileOffset Offs, StringRef text,\n                    bool beforePreviousInsertions);\n  bool commitInsertFromRange(SourceLocation OrigLoc, FileOffset Offs,\n                             FileOffset InsertFromRangeOffs, unsigned Len,\n                             bool beforePreviousInsertions);\n  void commitRemove(SourceLocation OrigLoc, FileOffset BeginOffs, unsigned Len);\n\n  StringRef getSourceText(FileOffset BeginOffs, FileOffset EndOffs,\n                          bool &Invalid);\n  FileEditsTy::iterator getActionForOffset(FileOffset Offs);\n  void deconstructMacroArgLoc(SourceLocation Loc,\n                              SourceLocation &ExpansionLoc,\n                              MacroArgUse &ArgUse);\n\n  void startingCommit();\n  void finishedCommit();\n};\n\n}",
  "id": "BLOCK-CPP-17958",
  "language": "c++",
  "source_file": "/storage/emulated/0/Download/cpp_codebases/llvm/clang/include/clang/Edit/EditedSource.h",
  "source_line": 30,
  "validation_status": "validated"
}
{
  "code": "{\npublic:\n  enum EditKind {\n    Act_Insert,\n    Act_InsertFromRange,\n    Act_Remove\n  };\n\n  struct Edit {\n    EditKind Kind;\n    StringRef Text;\n    SourceLocation OrigLoc;\n    FileOffset Offset;\n    FileOffset InsertFromRangeOffs;\n    unsigned Length;\n    bool BeforePrev;\n\n    SourceLocation getFileLocation(SourceManager &SM) const;\n    CharSourceRange getFileRange(SourceManager &SM) const;\n    CharSourceRange getInsertFromRange(SourceManager &SM) const;\n  };\n\nprivate:\n  const SourceManager &SourceMgr;\n  const LangOptions &LangOpts;\n  const PPConditionalDirectiveRecord *PPRec;\n  EditedSource *Editor = nullptr;\n\n  bool IsCommitable = true;\n  SmallVector<Edit, 8> CachedEdits;\n\n  llvm::BumpPtrAllocator StrAlloc;\n\npublic:\n  explicit Commit(EditedSource &Editor);\n  Commit(const SourceManager &SM, const LangOptions &LangOpts,\n         const PPConditionalDirectiveRecord *PPRec = nullptr)\n      : SourceMgr(SM), LangOpts(LangOpts), PPRec(PPRec) {}\n\n  bool isCommitable() const { return IsCommitable; }\n\n  bool insert(SourceLocation loc, StringRef text, bool afterToken = false,\n              bool beforePreviousInsertions = false);\n\n  bool insertAfterToken(SourceLocation loc, StringRef text,\n                        bool beforePreviousInsertions = false) {\n    return insert(loc, text, /*afterToken=*/true, beforePreviousInsertions);\n  }\n\n  bool insertBefore(SourceLocation loc, StringRef text) {\n    return insert(loc, text, /*afterToken=*/false,\n                  /*beforePreviousInsertions=*/true);\n  }\n\n  bool insertFromRange(SourceLocation loc, CharSourceRange range,\n                       bool afterToken = false,\n                       bool beforePreviousInsertions = false);\n  bool insertWrap(StringRef before, CharSourceRange range, StringRef after);\n\n  bool remove(CharSourceRange range);\n\n  bool replace(CharSourceRange range, StringRef text);\n  bool replaceWithInner(CharSourceRange range, CharSourceRange innerRange);\n  bool replaceText(SourceLocation loc, StringRef text,\n                   StringRef replacementText);\n\n  bool insertFromRange(SourceLocation loc, SourceRange TokenRange,\n                       bool afterToken = false,\n                       bool beforePreviousInsertions = false) {\n    return insertFromRange(loc, CharSourceRange::getTokenRange(TokenRange),\n                           afterToken, beforePreviousInsertions);\n  }\n\n  bool insertWrap(StringRef before, SourceRange TokenRange, StringRef after) {\n    return insertWrap(before, CharSourceRange::getTokenRange(TokenRange), after);\n  }\n\n  bool remove(SourceRange TokenRange) {\n    return remove(CharSourceRange::getTokenRange(TokenRange));\n  }\n\n  bool replace(SourceRange TokenRange, StringRef text) {\n    return replace(CharSourceRange::getTokenRange(TokenRange), text);\n  }\n\n  bool replaceWithInner(SourceRange TokenRange, SourceRange TokenInnerRange) {\n    return replaceWithInner(CharSourceRange::getTokenRange(TokenRange),\n                            CharSourceRange::getTokenRange(TokenInnerRange));\n  }\n\n  using edit_iterator = SmallVectorImpl<Edit>::const_iterator;\n\n  edit_iterator edit_begin() const { return CachedEdits.begin(); }\n  edit_iterator edit_end() const { return CachedEdits.end(); }\n\nprivate:\n  void addInsert(SourceLocation OrigLoc,\n                FileOffset Offs, StringRef text, bool beforePreviousInsertions);\n  void addInsertFromRange(SourceLocation OrigLoc, FileOffset Offs,\n                          FileOffset RangeOffs, unsigned RangeLen,\n                          bool beforePreviousInsertions);\n  void addRemove(SourceLocation OrigLoc, FileOffset Offs, unsigned Len);\n\n  bool canInsert(SourceLocation loc, FileOffset &Offset);\n  bool canInsertAfterToken(SourceLocation loc, FileOffset &Offset,\n                           SourceLocation &AfterLoc);\n  bool canInsertInOffset(SourceLocation OrigLoc, FileOffset Offs);\n  bool canRemoveRange(CharSourceRange range, FileOffset &Offs, unsigned &Len);\n  bool canReplaceText(SourceLocation loc, StringRef text,\n                      FileOffset &Offs, unsigned &Len);\n\n  void commitInsert(FileOffset offset, StringRef text,\n                    bool beforePreviousInsertions);\n  void commitRemove(FileOffset offset, unsigned length);\n\n  bool isAtStartOfMacroExpansion(SourceLocation loc,\n                                 SourceLocation *MacroBegin = nullptr) const;\n  bool isAtEndOfMacroExpansion(SourceLocation loc,\n                               SourceLocation *MacroEnd = nullptr) const;\n}",
  "id": "BLOCK-CPP-17949",
  "language": "c++",
  "source_file": "/storage/emulated/0/Download/cpp_codebases/llvm/clang/include/clang/Edit/Commit.h",
  "source_line": 29,
  "validation_status": "validated"
}
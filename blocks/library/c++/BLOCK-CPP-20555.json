{
  "code": "{\n  public:\n    GlobalEagerInstantiationScope(Sema &S, bool Enabled)\n        : S(S), Enabled(Enabled) {\n      if (!Enabled) return;\n\n      S.SavedPendingInstantiations.emplace_back();\n      S.SavedPendingInstantiations.back().swap(S.PendingInstantiations);\n\n      S.SavedVTableUses.emplace_back();\n      S.SavedVTableUses.back().swap(S.VTableUses);\n    }\n\n    void perform() {\n      if (Enabled) {\n        S.DefineUsedVTables();\n        S.PerformPendingInstantiations();\n      }\n    }\n\n    ~GlobalEagerInstantiationScope() {\n      if (!Enabled) return;\n\n      // Restore the set of pending vtables.\n      assert(S.VTableUses.empty() &&\n             \"VTableUses should be empty before it is discarded.\");\n      S.VTableUses.swap(S.SavedVTableUses.back());\n      S.SavedVTableUses.pop_back();\n\n      // Restore the set of pending implicit instantiations.\n      if (S.TUKind != TU_Prefix || !S.LangOpts.PCHInstantiateTemplates) {\n        assert(S.PendingInstantiations.empty() &&\n               \"PendingInstantiations should be empty before it is discarded.\");\n        S.PendingInstantiations.swap(S.SavedPendingInstantiations.back());\n        S.SavedPendingInstantiations.pop_back();\n      } else {\n        // Template instantiations in the PCH may be delayed until the TU.\n        S.PendingInstantiations.swap(S.SavedPendingInstantiations.back());\n        S.PendingInstantiations.insert(\n            S.PendingInstantiations.end(),\n            S.SavedPendingInstantiations.back().begin(),\n            S.SavedPendingInstantiations.back().end());\n        S.SavedPendingInstantiations.pop_back();\n      }\n    }\n\n  private:\n    Sema &S;\n    bool Enabled;\n  }",
  "id": "BLOCK-CPP-20555",
  "language": "c++",
  "source_file": "/storage/emulated/0/Download/cpp_codebases/llvm/clang/include/clang/Sema/Sema.h",
  "source_line": 9954,
  "validation_status": "validated"
}
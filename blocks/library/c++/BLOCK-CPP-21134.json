{
  "code": "{\n///   CommonOptionsParser OptionsParser(argc, argv, MyToolCategory);\n///   ClangTool Tool(OptionsParser.getCompilations(),\n///                  OptionsParser.getSourcePathList());\n///   return Tool.run(newFrontendActionFactory<SyntaxOnlyAction>().get());\n/// }\n/// \\endcode\nclass CommonOptionsParser {\n\nprotected:\n  /// Parses command-line, initializes a compilation database.\n  ///\n  /// This constructor can change argc and argv contents, e.g. consume\n  /// command-line options used for creating FixedCompilationDatabase.\n  ///\n  /// All options not belonging to \\p Category become hidden.\n  ///\n  /// It also allows calls to set the required number of positional parameters.\n  CommonOptionsParser(\n      int &argc, const char **argv, llvm::cl::OptionCategory &Category,\n      llvm::cl::NumOccurrencesFlag OccurrencesFlag = llvm::cl::OneOrMore,\n      const char *Overview = nullptr);\n\npublic:\n  /// A factory method that is similar to the above constructor, except\n  /// this returns an error instead exiting the program on error.\n  static llvm::Expected<CommonOptionsParser>\n  create(int &argc, const char **argv, llvm::cl::OptionCategory &Category,\n         llvm::cl::NumOccurrencesFlag OccurrencesFlag = llvm::cl::OneOrMore,\n         const char *Overview = nullptr);\n\n  /// Returns a reference to the loaded compilations database.\n  CompilationDatabase &getCompilations() {\n    return *Compilations;\n  }\n\n  /// Returns a list of source file paths to process.\n  const std::vector<std::string> &getSourcePathList() const {\n    return SourcePathList;\n  }\n\n  /// Returns the argument adjuster calculated from \"--extra-arg\" and\n  //\"--extra-arg-before\" options.\n  ArgumentsAdjuster getArgumentsAdjuster() { return Adjuster; }\n\n  static const char *const HelpMessage;\n\nprivate:\n  CommonOptionsParser() = default;\n\n  llvm::Error init(int &argc, const char **argv,\n                   llvm::cl::OptionCategory &Category,\n                   llvm::cl::NumOccurrencesFlag OccurrencesFlag,\n                   const char *Overview);\n\n  std::unique_ptr<CompilationDatabase> Compilations;\n  std::vector<std::string> SourcePathList;\n  ArgumentsAdjuster Adjuster;\n};\n\nclass ArgumentsAdjustingCompilations : public CompilationDatabase {\npublic:\n  ArgumentsAdjustingCompilations(\n      std::unique_ptr<CompilationDatabase> Compilations)\n      : Compilations(std::move(Compilations)) {}\n\n  void appendArgumentsAdjuster(ArgumentsAdjuster Adjuster);\n\n  std::vector<CompileCommand>\n  getCompileCommands(StringRef FilePath) const override;\n\n  std::vector<std::string> getAllFiles() const override;\n\n  std::vector<CompileCommand> getAllCompileCommands() const override;\n\nprivate:\n  std::unique_ptr<CompilationDatabase> Compilations;\n  std::vector<ArgumentsAdjuster> Adjusters;\n\n  std::vector<CompileCommand>\n  adjustCommands(std::vector<CompileCommand> Commands) const;\n};\n\n}",
  "id": "BLOCK-CPP-21134",
  "language": "c++",
  "source_file": "/storage/emulated/0/Download/cpp_codebases/llvm/clang/include/clang/Tooling/CommonOptionsParser.h",
  "source_line": 58,
  "validation_status": "validated"
}
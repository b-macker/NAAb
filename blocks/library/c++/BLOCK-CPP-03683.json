{
  "code": "{\nABSL_NAMESPACE_BEGIN\n\n// LogStreamer\n//\n// Although you can stream into `LOG(INFO)`, you can't pass it into a function\n// that takes a `std::ostream` parameter. `LogStreamer::stream()` provides a\n// `std::ostream` that buffers everything that's streamed in.  The buffer's\n// contents are logged as if by `LOG` when the `LogStreamer` is destroyed.\n// If nothing is streamed in, an empty message is logged.  If the specified\n// severity is `absl::LogSeverity::kFatal`, the program will be terminated when\n// the `LogStreamer` is destroyed regardless of whether any data were streamed\n// in.\n//\n// Factory functions corresponding to the `absl::LogSeverity` enumerators\n// are provided for convenience; if the desired severity is variable, invoke the\n// constructor directly.\n//\n// LogStreamer is movable, but not copyable.\n//\n// Examples:\n//\n//   ShaveYakAndWriteToStream(\n//       yak, absl::LogInfoStreamer(__FILE__, __LINE__).stream());\n//\n//   {\n//     // This logs a single line containing data streamed by all three function\n//     // calls.\n//     absl::LogStreamer streamer(absl::LogSeverity::kInfo, __FILE__, __LINE__);\n//     ShaveYakAndWriteToStream(yak1, streamer.stream());\n//     streamer.stream() << \" \";\n//     ShaveYakAndWriteToStream(yak2, streamer.stream());\n//     streamer.stream() << \" \";\n//     ShaveYakAndWriteToStreamPointer(yak3, &streamer.stream());\n//   }\nclass LogStreamer final {\n public:\n  // LogStreamer::LogStreamer()\n  //\n  // Creates a LogStreamer with a given `severity` that will log a message\n  // attributed to the given `file` and `line`.\n  explicit LogStreamer(absl::LogSeverity severity, absl::string_view file,\n                       int line)\n      : severity_(severity),\n        line_(line),\n        file_(file),\n        stream_(absl::in_place, &buf_) {\n    // To match `LOG`'s defaults:\n    stream_->setf(std::ios_base::showbase | std::ios_base::boolalpha);\n  }\n\n  // A moved-from `absl::LogStreamer` does not `LOG` when destroyed,\n  // and a program that streams into one has undefined behavior.\n  LogStreamer(LogStreamer&& that) noexcept\n      : severity_(that.severity_),\n        line_(that.line_),\n        file_(std::move(that.file_)),\n        buf_(std::move(that.buf_)),\n        stream_(std::move(that.stream_)) {\n    if (stream_.has_value()) stream_->str(&buf_);\n    that.stream_.reset();\n  }\n  LogStreamer& operator=(LogStreamer&& that) {\n    ABSL_LOG_IF(LEVEL(severity_), stream_).AtLocation(file_, line_) << buf_;\n    severity_ = that.severity_;\n    file_ = std::move(that.file_);\n    line_ = that.line_;\n    buf_ = std::move(that.buf_);\n    stream_ = std::move(that.stream_);\n    if (stream_.has_value()) stream_->str(&buf_);\n    that.stream_.reset();\n    return *this;\n  }\n\n  // LogStreamer::~LogStreamer()\n  //\n  // Logs this LogStreamer's buffered content as if by LOG.\n  ~LogStreamer() {\n    ABSL_LOG_IF(LEVEL(severity_), stream_.has_value()).AtLocation(file_, line_)\n        << buf_;\n  }\n\n  // LogStreamer::stream()\n  //\n  // Returns the `std::ostream` to use to write into this LogStreamer' internal\n  // buffer.\n  std::ostream& stream() { return *stream_; }\n\n private:\n  absl::LogSeverity severity_;\n  int line_;\n  std::string file_;\n  std::string buf_;\n  // A disengaged `stream_` indicates a moved-from `LogStreamer` that should not\n  // `LOG` upon destruction.\n  absl::optional<absl::strings_internal::OStringStream> stream_;\n};\n\n// LogInfoStreamer()\n//\n// Returns a LogStreamer that writes at level LogSeverity::kInfo.\ninline LogStreamer LogInfoStreamer(absl::string_view file, int line) {\n  return absl::LogStreamer(absl::LogSeverity::kInfo, file, line);\n}\n\n// LogWarningStreamer()\n//\n// Returns a LogStreamer that writes at level LogSeverity::kWarning.\ninline LogStreamer LogWarningStreamer(absl::string_view file, int line) {\n  return absl::LogStreamer(absl::LogSeverity::kWarning, file, line);\n}\n\n// LogErrorStreamer()\n//\n// Returns a LogStreamer that writes at level LogSeverity::kError.\ninline LogStreamer LogErrorStreamer(absl::string_view file, int line) {\n  return absl::LogStreamer(absl::LogSeverity::kError, file, line);\n}\n\n// LogFatalStreamer()\n//\n// Returns a LogStreamer that writes at level LogSeverity::kFatal.\n//\n// The program will be terminated when this `LogStreamer` is destroyed,\n// regardless of whether any data were streamed in.\ninline LogStreamer LogFatalStreamer(absl::string_view file, int line) {\n  return absl::LogStreamer(absl::LogSeverity::kFatal, file, line);\n}\n\n// LogDebugFatalStreamer()\n//\n// Returns a LogStreamer that writes at level LogSeverity::kLogDebugFatal.\n//\n// In debug mode, the program will be terminated when this `LogStreamer` is\n// destroyed, regardless of whether any data were streamed in.\ninline LogStreamer LogDebugFatalStreamer(absl::string_view file, int line) {\n  return absl::LogStreamer(absl::kLogDebugFatal, file, line);\n}\n\nABSL_NAMESPACE_END\n}",
  "id": "BLOCK-CPP-03683",
  "language": "c++",
  "source_file": "/storage/emulated/0/Download/cpp_codebases/abseil/absl/log/log_streamer.h",
  "source_line": 39,
  "validation_status": "validated"
}
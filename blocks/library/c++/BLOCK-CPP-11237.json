{
  "code": "{\n\nenum class DynamicInitKind : unsigned {\n  NoStub = 0,\n  Initializer,\n  AtExit,\n  GlobalArrayDestructor\n};\n\nenum class KernelReferenceKind : unsigned {\n  Kernel = 0,\n  Stub = 1,\n};\n\n/// GlobalDecl - represents a global declaration. This can either be a\n/// CXXConstructorDecl and the constructor type (Base, Complete).\n/// a CXXDestructorDecl and the destructor type (Base, Complete),\n/// a FunctionDecl and the kernel reference type (Kernel, Stub), or\n/// a VarDecl, a FunctionDecl or a BlockDecl.\n///\n/// When a new type of GlobalDecl is added, the following places should\n/// be updated to convert a Decl* to a GlobalDecl:\n/// PredefinedExpr::ComputeName() in lib/AST/Expr.cpp.\n/// getParentOfLocalEntity() in lib/AST/ItaniumMangle.cpp\n/// ASTNameGenerator::Implementation::writeFuncOrVarName in lib/AST/Mangle.cpp\n///\nclass GlobalDecl {\n  llvm::PointerIntPair<const Decl *, 3> Value;\n  unsigned MultiVersionIndex = 0;\n\n  void Init(const Decl *D) {\n    assert(!isa<CXXConstructorDecl>(D) && \"Use other ctor with ctor decls!\");\n    assert(!isa<CXXDestructorDecl>(D) && \"Use other ctor with dtor decls!\");\n    assert(!D->hasAttr<CUDAGlobalAttr>() && \"Use other ctor with GPU kernels!\");\n\n    Value.setPointer(D);\n  }\n\npublic:\n  GlobalDecl() = default;\n  GlobalDecl(const VarDecl *D) { Init(D);}\n  GlobalDecl(const FunctionDecl *D, unsigned MVIndex = 0)\n      : MultiVersionIndex(MVIndex) {\n    if (!D->hasAttr<CUDAGlobalAttr>()) {\n      Init(D);\n      return;\n    }\n    Value.setPointerAndInt(D, unsigned(getDefaultKernelReference(D)));\n  }\n  GlobalDecl(const FunctionDecl *D, KernelReferenceKind Kind)\n      : Value(D, unsigned(Kind)) {\n    assert(D->hasAttr<CUDAGlobalAttr>() && \"Decl is not a GPU kernel!\");\n  }\n  GlobalDecl(const NamedDecl *D) { Init(D); }\n  GlobalDecl(const BlockDecl *D) { Init(D); }\n  GlobalDecl(const CapturedDecl *D) { Init(D); }\n  GlobalDecl(const ObjCMethodDecl *D) { Init(D); }\n  GlobalDecl(const OMPDeclareReductionDecl *D) { Init(D); }\n  GlobalDecl(const OMPDeclareMapperDecl *D) { Init(D); }\n  GlobalDecl(const CXXConstructorDecl *D, CXXCtorType Type) : Value(D, Type) {}\n  GlobalDecl(const CXXDestructorDecl *D, CXXDtorType Type) : Value(D, Type) {}\n  GlobalDecl(const VarDecl *D, DynamicInitKind StubKind)\n      : Value(D, unsigned(StubKind)) {}\n\n  GlobalDecl getCanonicalDecl() const {\n    GlobalDecl CanonGD;\n    CanonGD.Value.setPointer(Value.getPointer()->getCanonicalDecl());\n    CanonGD.Value.setInt(Value.getInt());\n    CanonGD.MultiVersionIndex = MultiVersionIndex;\n\n    return CanonGD;\n  }\n\n  const Decl *getDecl() const { return Value.getPointer(); }\n\n  CXXCtorType getCtorType() const {\n    assert(isa<CXXConstructorDecl>(getDecl()) && \"Decl is not a ctor!\");\n    return static_cast<CXXCtorType>(Value.getInt());\n  }\n\n  CXXDtorType getDtorType() const {\n    assert(isa<CXXDestructorDecl>(getDecl()) && \"Decl is not a dtor!\");\n    return static_cast<CXXDtorType>(Value.getInt());\n  }\n\n  DynamicInitKind getDynamicInitKind() const {\n    assert(isa<VarDecl>(getDecl()) &&\n           cast<VarDecl>(getDecl())->hasGlobalStorage() &&\n           \"Decl is not a global variable!\");\n    return static_cast<DynamicInitKind>(Value.getInt());\n  }\n\n  unsigned getMultiVersionIndex() const {\n    assert(isa<FunctionDecl>(\n               getDecl()) &&\n               !cast<FunctionDecl>(getDecl())->hasAttr<CUDAGlobalAttr>() &&\n           !isa<CXXConstructorDecl>(getDecl()) &&\n           !isa<CXXDestructorDecl>(getDecl()) &&\n           \"Decl is not a plain FunctionDecl!\");\n    return MultiVersionIndex;\n  }\n\n  KernelReferenceKind getKernelReferenceKind() const {\n    assert(((isa<FunctionDecl>(getDecl()) &&\n             cast<FunctionDecl>(getDecl())->hasAttr<CUDAGlobalAttr>()) ||\n            (isa<FunctionTemplateDecl>(getDecl()) &&\n             cast<FunctionTemplateDecl>(getDecl())\n                 ->getTemplatedDecl()\n                 ->hasAttr<CUDAGlobalAttr>())) &&\n           \"Decl is not a GPU kernel!\");\n    return static_cast<KernelReferenceKind>(Value.getInt());\n  }\n\n  friend bool operator==(const GlobalDecl &LHS, const GlobalDecl &RHS) {\n    return LHS.Value == RHS.Value &&\n           LHS.MultiVersionIndex == RHS.MultiVersionIndex;\n  }\n\n  void *getAsOpaquePtr() const { return Value.getOpaqueValue(); }\n\n  explicit operator bool() const { return getAsOpaquePtr(); }\n\n  static GlobalDecl getFromOpaquePtr(void *P) {\n    GlobalDecl GD;\n    GD.Value.setFromOpaqueValue(P);\n    return GD;\n  }\n\n  static KernelReferenceKind getDefaultKernelReference(const FunctionDecl *D) {\n    return D->getLangOpts().CUDAIsDevice ? KernelReferenceKind::Kernel\n                                         : KernelReferenceKind::Stub;\n  }\n\n  GlobalDecl getWithDecl(const Decl *D) {\n    GlobalDecl Result(*this);\n    Result.Value.setPointer(D);\n    return Result;\n  }\n\n  GlobalDecl getWithCtorType(CXXCtorType Type) {\n    assert(isa<CXXConstructorDecl>(getDecl()));\n    GlobalDecl Result(*this);\n    Result.Value.setInt(Type);\n    return Result;\n  }\n\n  GlobalDecl getWithDtorType(CXXDtorType Type) {\n    assert(isa<CXXDestructorDecl>(getDecl()));\n    GlobalDecl Result(*this);\n    Result.Value.setInt(Type);\n    return Result;\n  }\n\n  GlobalDecl getWithMultiVersionIndex(unsigned Index) {\n    assert(isa<FunctionDecl>(getDecl()) &&\n           !cast<FunctionDecl>(getDecl())->hasAttr<CUDAGlobalAttr>() &&\n           !isa<CXXConstructorDecl>(getDecl()) &&\n           !isa<CXXDestructorDecl>(getDecl()) &&\n           \"Decl is not a plain FunctionDecl!\");\n    GlobalDecl Result(*this);\n    Result.MultiVersionIndex = Index;\n    return Result;\n  }\n\n  GlobalDecl getWithKernelReferenceKind(KernelReferenceKind Kind) {\n    assert(isa<FunctionDecl>(getDecl()) &&\n           cast<FunctionDecl>(getDecl())->hasAttr<CUDAGlobalAttr>() &&\n           \"Decl is not a GPU kernel!\");\n    GlobalDecl Result(*this);\n    Result.Value.setInt(unsigned(Kind));\n    return Result;\n  }\n};\n\n}",
  "id": "BLOCK-CPP-11237",
  "language": "c++",
  "source_file": "/storage/emulated/0/Download/cpp_codebases/llvm/clang/include/clang/AST/GlobalDecl.h",
  "source_line": 30,
  "validation_status": "validated"
}
{
  "code": "{\nclass HeaderMap;\nclass HeaderSearch;\nclass Module;\n\n/// DirectoryLookup - This class represents one entry in the search list that\n/// specifies the search order for directories in \\#include directives.  It\n/// represents either a directory, a framework, or a headermap.\n///\nclass DirectoryLookup {\npublic:\n  enum LookupType_t {\n    LT_NormalDir,\n    LT_Framework,\n    LT_HeaderMap\n  };\nprivate:\n  union DLU { // This union is discriminated by isHeaderMap.\n    /// Dir - This is the actual directory that we're referring to for a normal\n    /// directory or a framework.\n    DirectoryEntryRef Dir;\n\n    /// Map - This is the HeaderMap if this is a headermap lookup.\n    ///\n    const HeaderMap *Map;\n\n    DLU(DirectoryEntryRef Dir) : Dir(Dir) {}\n    DLU(const HeaderMap *Map) : Map(Map) {}\n  } u;\n\n  /// DirCharacteristic - The type of directory this is: this is an instance of\n  /// SrcMgr::CharacteristicKind.\n  unsigned DirCharacteristic : 3;\n\n  /// LookupType - This indicates whether this DirectoryLookup object is a\n  /// normal directory, a framework, or a headermap.\n  unsigned LookupType : 2;\n\n  /// Whether this is a header map used when building a framework.\n  unsigned IsIndexHeaderMap : 1;\n\n  /// Whether we've performed an exhaustive search for module maps\n  /// within the subdirectories of this directory.\n  unsigned SearchedAllModuleMaps : 1;\n\npublic:\n  /// This ctor *does not take ownership* of 'Dir'.\n  DirectoryLookup(DirectoryEntryRef Dir, SrcMgr::CharacteristicKind DT,\n                  bool isFramework)\n      : u(Dir), DirCharacteristic(DT),\n        LookupType(isFramework ? LT_Framework : LT_NormalDir),\n        IsIndexHeaderMap(false), SearchedAllModuleMaps(false) {}\n\n  /// This ctor *does not take ownership* of 'Map'.\n  DirectoryLookup(const HeaderMap *Map, SrcMgr::CharacteristicKind DT,\n                  bool isIndexHeaderMap)\n      : u(Map), DirCharacteristic(DT), LookupType(LT_HeaderMap),\n        IsIndexHeaderMap(isIndexHeaderMap), SearchedAllModuleMaps(false) {}\n\n  /// getLookupType - Return the kind of directory lookup that this is: either a\n  /// normal directory, a framework path, or a HeaderMap.\n  LookupType_t getLookupType() const { return (LookupType_t)LookupType; }\n\n  /// getName - Return the directory or filename corresponding to this lookup\n  /// object.\n  StringRef getName() const;\n\n  /// getDir - Return the directory that this entry refers to.\n  ///\n  const DirectoryEntry *getDir() const {\n    return isNormalDir() ? &u.Dir.getDirEntry() : nullptr;\n  }\n\n  OptionalDirectoryEntryRef getDirRef() const {\n    return isNormalDir() ? OptionalDirectoryEntryRef(u.Dir) : std::nullopt;\n  }\n\n  /// getFrameworkDir - Return the directory that this framework refers to.\n  ///\n  const DirectoryEntry *getFrameworkDir() const {\n    return isFramework() ? &u.Dir.getDirEntry() : nullptr;\n  }\n\n  OptionalDirectoryEntryRef getFrameworkDirRef() const {\n    return isFramework() ? OptionalDirectoryEntryRef(u.Dir) : std::nullopt;\n  }\n\n  /// getHeaderMap - Return the directory that this entry refers to.\n  ///\n  const HeaderMap *getHeaderMap() const {\n    return isHeaderMap() ? u.Map : nullptr;\n  }\n\n  /// isNormalDir - Return true if this is a normal directory, not a header map.\n  bool isNormalDir() const { return getLookupType() == LT_NormalDir; }\n\n  /// isFramework - True if this is a framework directory.\n  ///\n  bool isFramework() const { return getLookupType() == LT_Framework; }\n\n  /// isHeaderMap - Return true if this is a header map, not a normal directory.\n  bool isHeaderMap() const { return getLookupType() == LT_HeaderMap; }\n\n  /// Determine whether we have already searched this entire\n  /// directory for module maps.\n  bool haveSearchedAllModuleMaps() const { return SearchedAllModuleMaps; }\n\n  /// Specify whether we have already searched all of the subdirectories\n  /// for module maps.\n  void setSearchedAllModuleMaps(bool SAMM) {\n    SearchedAllModuleMaps = SAMM;\n  }\n\n  /// DirCharacteristic - The type of directory this is, one of the DirType enum\n  /// values.\n  SrcMgr::CharacteristicKind getDirCharacteristic() const {\n    return (SrcMgr::CharacteristicKind)DirCharacteristic;\n  }\n\n  /// Whether this describes a system header directory.\n  bool isSystemHeaderDirectory() const {\n    return getDirCharacteristic() != SrcMgr::C_User;\n  }\n\n  /// Whether this header map is building a framework or not.\n  bool isIndexHeaderMap() const {\n    return isHeaderMap() && IsIndexHeaderMap;\n  }\n\n  /// LookupFile - Lookup the specified file in this search path, returning it\n  /// if it exists or returning null if not.\n  ///\n  /// \\param Filename The file to look up relative to the search paths.\n  ///\n  /// \\param HS The header search instance to search with.\n  ///\n  /// \\param IncludeLoc the source location of the #include or #import\n  /// directive.\n  ///\n  /// \\param SearchPath If not NULL, will be set to the search path relative\n  /// to which the file was found.\n  ///\n  /// \\param RelativePath If not NULL, will be set to the path relative to\n  /// SearchPath at which the file was found. This only differs from the\n  /// Filename for framework includes.\n  ///\n  /// \\param RequestingModule The module in which the lookup was performed.\n  ///\n  /// \\param SuggestedModule If non-null, and the file found is semantically\n  /// part of a known module, this will be set to the module that should\n  /// be imported instead of preprocessing/parsing the file found.\n  ///\n  /// \\param [out] InUserSpecifiedSystemFramework If the file is found,\n  /// set to true if the file is located in a framework that has been\n  /// user-specified to be treated as a system framework.\n  ///\n  /// \\param [out] IsFrameworkFound For a framework directory set to true if\n  /// specified '.framework' directory is found.\n  ///\n  /// \\param [out] MappedName if this is a headermap which maps the filename to\n  /// a framework include (\"Foo.h\" -> \"Foo/Foo.h\"), set the new name to this\n  /// vector and point Filename to it.\n  OptionalFileEntryRef\n  LookupFile(StringRef &Filename, HeaderSearch &HS, SourceLocation IncludeLoc,\n             SmallVectorImpl<char> *SearchPath,\n             SmallVectorImpl<char> *RelativePath, Module *RequestingModule,\n             ModuleMap::KnownHeader *SuggestedModule,\n             bool &InUserSpecifiedSystemFramework, bool &IsFrameworkFound,\n             bool &IsInHeaderMap, SmallVectorImpl<char> &MappedName,\n             bool OpenFile = true) const;\n\nprivate:\n  OptionalFileEntryRef DoFrameworkLookup(\n      StringRef Filename, HeaderSearch &HS, SmallVectorImpl<char> *SearchPath,\n      SmallVectorImpl<char> *RelativePath, Module *RequestingModule,\n      ModuleMap::KnownHeader *SuggestedModule,\n      bool &InUserSpecifiedSystemFramework, bool &IsFrameworkFound) const;\n};\n\n}",
  "id": "BLOCK-CPP-18559",
  "language": "c++",
  "source_file": "/storage/emulated/0/Download/cpp_codebases/llvm/clang/include/clang/Lex/DirectoryLookup.h",
  "source_line": 21,
  "validation_status": "validated"
}
{
  "code": "#include \"clang/AST/ASTContext.h\"\n#include \"clang/AST/Expr.h\"\n\nusing namespace clang;\nusing namespace analyze_os_log;\n\nextern \"C\" {\n\nvoid BLOCK-CPP-11366_execute() {\n    {\npublic:\n  enum Kind {\n    // The item is a scalar (int, float, raw pointer, etc.). No further copying\n    // is required. This is the only kind allowed by os_trace().\n    ScalarKind = 0,\n\n    // The item is a count, which describes the length of the following item to\n    // be copied. A count may only be followed by an item of kind StringKind,\n    // WideStringKind, or PointerKind.\n    CountKind,\n\n    // The item is a pointer to a C string. If preceded by a count 'n',\n    // os_log() will copy at most 'n' bytes from the pointer.\n    StringKind,\n\n    // The item is a pointer to a block of raw data. This item must be preceded\n    // by a count 'n'. os_log() will copy exactly 'n' bytes from the pointer.\n    PointerKind,\n\n    // The item is a pointer to an Objective-C object. os_log() may retain the\n    // object for later processing.\n    ObjCObjKind,\n\n    // The item is a pointer to wide-char string.\n    WideStringKind,\n\n    // The item is corresponding to the '%m' format specifier, no value is\n    // populated in the buffer and the runtime is loading the errno value.\n    ErrnoKind,\n\n    // The item is a mask type.\n    MaskKind\n  };\n\n  enum {\n    // The item is marked \"private\" in the format string.\n    IsPrivate = 0x1,\n\n    // The item is marked \"public\" in the format string.\n    IsPublic = 0x2,\n\n    // The item is marked \"sensitive\" in the format string.\n    IsSensitive = 0x4 | IsPrivate\n  };\n\nprivate:\n  Kind TheKind = ScalarKind;\n  const Expr *TheExpr = nullptr;\n  CharUnits ConstValue;\n  CharUnits Size; // size of the data, not including the header bytes\n  unsigned Flags = 0;\n  StringRef MaskType;\n\npublic:\n  OSLogBufferItem(Kind kind, const Expr *expr, CharUnits size, unsigned flags,\n                  StringRef maskType = StringRef())\n      : TheKind(kind), TheExpr(expr), Size(size), Flags(flags),\n        MaskType(maskType) {\n    assert(((Flags == 0) || (Flags == IsPrivate) || (Flags == IsPublic) ||\n            (Flags == IsSensitive)) &&\n           \"unexpected privacy flag\");\n  }\n\n  OSLogBufferItem(ASTContext &Ctx, CharUnits value, unsigned flags)\n      : TheKind(CountKind), ConstValue(value),\n        Size(Ctx.getTypeSizeInChars(Ctx.IntTy)), Flags(flags) {}\n\n  unsigned char getDescriptorByte() const {\n    unsigned char result = Flags;\n    result |= ((unsigned)getKind()) << 4;\n    return result;\n  }\n\n  unsigned char getSizeByte() const { return size().getQuantity(); }\n\n  Kind getKind() const { return TheKind; }\n  bool getIsPrivate() const { return (Flags & IsPrivate) != 0; }\n\n  const Expr *getExpr() const { return TheExpr; }\n  CharUnits getConstValue() const { return ConstValue; }\n  CharUnits size() const { return Size; }\n\n  StringRef getMaskType() const { return MaskType; }\n}\n}\n\n} // extern \"C\"\n",
  "id": "BLOCK-CPP-11366",
  "language": "c++",
  "source_file": "/storage/emulated/0/Download/cpp_codebases/llvm/clang/include/clang/AST/OSLog.h",
  "source_line": 25,
  "validation_status": "validated"
}
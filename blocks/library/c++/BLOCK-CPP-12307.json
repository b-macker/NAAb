{
  "code": "#include \"clang/AST/APValue.h\"\n#include \"clang/Basic/PartialDiagnostic.h\"\n#include \"llvm/ADT/APFloat.h\"\n#include \"llvm/ADT/APSInt.h\"\n#include \"llvm/ADT/SmallVector.h\"\n#include \"llvm/ADT/StringRef.h\"\n\nusing namespace clang;\n\nextern \"C\" {\n\nvoid BLOCK-CPP-12307_execute() {\n    {\n\n/// A partial diagnostic which we might know in advance that we are not going\n/// to emit.\nclass OptionalDiagnostic {\n  PartialDiagnostic *Diag;\n\npublic:\n  explicit OptionalDiagnostic(PartialDiagnostic *Diag = nullptr) : Diag(Diag) {}\n\n  template <typename T> OptionalDiagnostic &operator<<(const T &v) {\n    if (Diag)\n      *Diag << v;\n    return *this;\n  }\n\n  OptionalDiagnostic &operator<<(const llvm::APSInt &I) {\n    if (Diag) {\n      SmallVector<char, 32> Buffer;\n      I.toString(Buffer);\n      *Diag << StringRef(Buffer.data(), Buffer.size());\n    }\n    return *this;\n  }\n\n  OptionalDiagnostic &operator<<(const llvm::APFloat &F) {\n    if (Diag) {\n      // FIXME: Force the precision of the source value down so we don't\n      // print digits which are usually useless (we don't really care here if\n      // we truncate a digit by accident in edge cases).  Ideally,\n      // APFloat::toString would automatically print the shortest\n      // representation which rounds to the correct value, but it's a bit\n      // tricky to implement. Could use std::to_chars.\n      unsigned precision = llvm::APFloat::semanticsPrecision(F.getSemantics());\n      precision = (precision * 59 + 195) / 196;\n      SmallVector<char, 32> Buffer;\n      F.toString(Buffer, precision);\n      *Diag << StringRef(Buffer.data(), Buffer.size());\n    }\n    return *this;\n  }\n\n  OptionalDiagnostic &operator<<(const llvm::APFixedPoint &FX) {\n    if (Diag) {\n      SmallVector<char, 32> Buffer;\n      FX.toString(Buffer);\n      *Diag << StringRef(Buffer.data(), Buffer.size());\n    }\n    return *this;\n  }\n};\n\n}\n}\n\n} // extern \"C\"\n",
  "id": "BLOCK-CPP-12307",
  "language": "c++",
  "source_file": "/storage/emulated/0/Download/cpp_codebases/llvm/clang/include/clang/AST/OptionalDiagnostic.h",
  "source_line": 24,
  "validation_status": "validated"
}
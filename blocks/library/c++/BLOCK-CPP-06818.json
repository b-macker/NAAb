{
  "code": "{\n  class ASTContext;\n  class DiagnosticConsumer;\n  class PCHContainerOperations;\n\nnamespace arcmt {\n  class MigrationPass;\n\n/// Creates an AST with the provided CompilerInvocation but with these\n/// changes:\n///   -if a PCH/PTH is set, the original header is used instead\n///   -Automatic Reference Counting mode is enabled\n///\n/// It then checks the AST and produces errors/warning for ARC migration issues\n/// that the user needs to handle manually.\n///\n/// \\param emitPremigrationARCErrors if true all ARC errors will get emitted\n/// even if the migrator can fix them, but the function will still return false\n/// if all ARC errors can be fixed.\n///\n/// \\param plistOut if non-empty, it is the file path to store the plist with\n/// the pre-migration ARC diagnostics.\n///\n/// \\returns false if no error is produced, true otherwise.\nbool\ncheckForManualIssues(CompilerInvocation &CI, const FrontendInputFile &Input,\n                     std::shared_ptr<PCHContainerOperations> PCHContainerOps,\n                     DiagnosticConsumer *DiagClient,\n                     bool emitPremigrationARCErrors = false,\n                     StringRef plistOut = StringRef());\n\n/// Works similar to checkForManualIssues but instead of checking, it\n/// applies automatic modifications to source files to conform to ARC.\n///\n/// \\returns false if no error is produced, true otherwise.\nbool\napplyTransformations(CompilerInvocation &origCI,\n                     const FrontendInputFile &Input,\n                     std::shared_ptr<PCHContainerOperations> PCHContainerOps,\n                     DiagnosticConsumer *DiagClient);\n\n/// Applies automatic modifications and produces temporary files\n/// and metadata into the \\p outputDir path.\n///\n/// \\param emitPremigrationARCErrors if true all ARC errors will get emitted\n/// even if the migrator can fix them, but the function will still return false\n/// if all ARC errors can be fixed.\n///\n/// \\param plistOut if non-empty, it is the file path to store the plist with\n/// the pre-migration ARC diagnostics.\n///\n/// \\returns false if no error is produced, true otherwise.\nbool migrateWithTemporaryFiles(\n    CompilerInvocation &origCI, const FrontendInputFile &Input,\n    std::shared_ptr<PCHContainerOperations> PCHContainerOps,\n    DiagnosticConsumer *DiagClient, StringRef outputDir,\n    bool emitPremigrationARCErrors, StringRef plistOut);\n\n/// Get the set of file remappings from the \\p outputDir path that\n/// migrateWithTemporaryFiles produced.\n///\n/// \\returns false if no error is produced, true otherwise.\nbool getFileRemappings(std::vector<std::pair<std::string,std::string> > &remap,\n                       StringRef outputDir,\n                       DiagnosticConsumer *DiagClient);\n\n/// Get the set of file remappings from a list of files with remapping\n/// info.\n///\n/// \\returns false if no error is produced, true otherwise.\nbool getFileRemappingsFromFileList(\n                        std::vector<std::pair<std::string,std::string> > &remap,\n                        ArrayRef<StringRef> remapFiles,\n                        DiagnosticConsumer *DiagClient);\n\ntypedef void (*TransformFn)(MigrationPass &pass);\n\nstd::vector<TransformFn> getAllTransformations(LangOptions::GCMode OrigGCMode,\n                                               bool NoFinalizeRemoval);\n\nclass MigrationProcess {\n  CompilerInvocation OrigCI;\n  std::shared_ptr<PCHContainerOperations> PCHContainerOps;\n  DiagnosticConsumer *DiagClient;\n  FileRemapper Remapper;\n\npublic:\n  bool HadARCErrors;\n\n  MigrationProcess(const CompilerInvocation &CI,\n                   std::shared_ptr<PCHContainerOperations> PCHContainerOps,\n                   DiagnosticConsumer *diagClient,\n                   StringRef outputDir = StringRef());\n\n  class RewriteListener {\n  public:\n    virtual ~RewriteListener();\n\n    virtual void start(ASTContext &Ctx) { }\n    virtual void finish() { }\n\n    virtual void insert(SourceLocation loc, StringRef text) { }\n    virtual void remove(CharSourceRange range) { }\n  };\n\n  bool applyTransform(TransformFn trans, RewriteListener *listener = nullptr);\n\n  FileRemapper &getRemapper() { return Remapper; }\n};\n\n} // end namespace arcmt\n\n}",
  "id": "BLOCK-CPP-06818",
  "language": "c++",
  "source_file": "/storage/emulated/0/Download/cpp_codebases/llvm/clang/include/clang/ARCMigrate/ARCMT.h",
  "source_line": 16,
  "validation_status": "validated"
}
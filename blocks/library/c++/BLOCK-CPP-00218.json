{
  "code": "#include <spdlog/common.h>\n#include <tuple>\n\nusing namespace spdlog;\nusing namespace details;\n\nextern \"C\" {\n\nvoid BLOCK-CPP-00218_execute() {\n    {\n\n// Helper class for file sinks.\n// When failing to open a file, retry several times(5) with a delay interval(10 ms).\n// Throw spdlog_ex exception on errors.\n\nclass SPDLOG_API file_helper {\npublic:\n    file_helper() = default;\n    explicit file_helper(const file_event_handlers &event_handlers);\n\n    file_helper(const file_helper &) = delete;\n    file_helper &operator=(const file_helper &) = delete;\n    ~file_helper();\n\n    void open(const filename_t &fname, bool truncate = false);\n    void reopen(bool truncate);\n    void flush();\n    void sync();\n    void close();\n    void write(const memory_buf_t &buf);\n    size_t size() const;\n    const filename_t &filename() const;\n\n    //\n    // return file path and its extension:\n    //\n    // \"mylog.txt\" => (\"mylog\", \".txt\")\n    // \"mylog\" => (\"mylog\", \"\")\n    // \"mylog.\" => (\"mylog.\", \"\")\n    // \"/dir1/dir2/mylog.txt\" => (\"/dir1/dir2/mylog\", \".txt\")\n    //\n    // the starting dot in filenames is ignored (hidden files):\n    //\n    // \".mylog\" => (\".mylog\". \"\")\n    // \"my_folder/.mylog\" => (\"my_folder/.mylog\", \"\")\n    // \"my_folder/.mylog.txt\" => (\"my_folder/.mylog\", \".txt\")\n    static std::tuple<filename_t, filename_t> split_by_extension(const filename_t &fname);\n\nprivate:\n    const int open_tries_ = 5;\n    const unsigned int open_interval_ = 10;\n    std::FILE *fd_{nullptr};\n    filename_t filename_;\n    file_event_handlers event_handlers_;\n};\n}\n}\n\n} // extern \"C\"\n",
  "id": "BLOCK-CPP-00218",
  "language": "c++",
  "source_file": "/storage/emulated/0/Download/cpp_codebases/spdlog/include/spdlog/details/file_helper.h",
  "source_line": 10,
  "validation_status": "validated"
}
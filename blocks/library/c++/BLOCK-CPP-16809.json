{
  "code": "#include \"clang/Basic/SourceLocation.h\"\n#include \"clang/Basic/Version.h\"\n#include \"llvm/ADT/ArrayRef.h\"\n#include \"llvm/ADT/SmallVector.h\"\n#include \"llvm/ADT/StringMap.h\"\n#include \"llvm/ADT/StringRef.h\"\n#include \"llvm/Support/JSON.h\"\n#include <cassert>\n#include <cstddef>\n#include <cstdint>\n#include <initializer_list>\n#include <optional>\n#include <string>\n\nusing namespace clang;\nusing namespace detail;\nusing namespace detail;\n\nextern \"C\" {\n\nvoid BLOCK-CPP-16809_execute() {\n    {\nprivate:\n  const llvm::StringRef SchemaURI{\n      \"https://docs.oasis-open.org/sarif/sarif/v2.1.0/cos02/schemas/\"\n      \"sarif-schema-2.1.0.json\"};\n  const llvm::StringRef SchemaVersion{\"2.1.0\"};\n\n  /// \\internal\n  /// Return a pointer to the current tool. Asserts that a run exists.\n  llvm::json::Object &getCurrentTool();\n\n  /// \\internal\n  /// Checks if there is a run associated with this document.\n  ///\n  /// \\return true on success\n  bool hasRun() const;\n\n  /// \\internal\n  /// Reset portions of the internal state so that the document is ready to\n  /// receive data for a new run.\n  void reset();\n\n  /// \\internal\n  /// Return a mutable reference to the current run, after asserting it exists.\n  ///\n  /// \\note It is undefined behavior to call this if a run does not exist in\n  /// the SARIF document.\n  llvm::json::Object &getCurrentRun();\n\n  /// Create a code flow object for the given threadflows.\n  /// See \\ref ThreadFlow.\n  ///\n  /// \\note It is undefined behavior to call this if a run does not exist in\n  /// the SARIF document.\n  llvm::json::Object\n  createCodeFlow(const llvm::ArrayRef<ThreadFlow> ThreadFlows);\n\n  /// Add the given threadflows to the ones this SARIF document knows about.\n  llvm::json::Array\n  createThreadFlows(const llvm::ArrayRef<ThreadFlow> ThreadFlows);\n\n  /// Add the given \\ref CharSourceRange to the SARIF document as a physical\n  /// location, with its corresponding artifact.\n  llvm::json::Object createPhysicalLocation(const CharSourceRange &R);\n\npublic:\n  SarifDocumentWriter() = delete;\n\n  /// Create a new empty SARIF document with the given source manager.\n  SarifDocumentWriter(const SourceManager &SourceMgr) : SourceMgr(SourceMgr) {}\n\n  /// Release resources held by this SARIF document.\n  ~SarifDocumentWriter() = default;\n\n  /// Create a new run with which any upcoming analysis will be associated.\n  /// Each run requires specifying the tool that is generating reporting items.\n  void createRun(const llvm::StringRef ShortToolName,\n                 const llvm::StringRef LongToolName,\n                 const llvm::StringRef ToolVersion = CLANG_VERSION_STRING);\n\n  /// If there is a current run, end it.\n  ///\n  /// This method collects various book-keeping required to clear and close\n  /// resources associated with the current run, but may also allocate some\n  /// for the next run.\n  ///\n  /// Calling \\ref endRun before associating a run through \\ref createRun leads\n  /// to undefined behaviour.\n  void endRun();\n\n  /// Associate the given rule with the current run.\n  ///\n  /// Returns an integer rule index for the created rule that is unique within\n  /// the current run, which can then be used to create a \\ref SarifResult\n  /// to add to the current run. Note that a rule must exist before being\n  /// referenced by a result.\n  ///\n  /// \\pre\n  /// There must be a run associated with the document, failing to do so will\n  /// cause undefined behaviour.\n  size_t createRule(const SarifRule &Rule);\n\n  /// Append a new result to the currently in-flight run.\n  ///\n  /// \\pre\n  /// There must be a run associated with the document, failing to do so will\n  /// cause undefined behaviour.\n  /// \\pre\n  /// \\c RuleIdx used to create the result must correspond to a rule known by\n  /// the SARIF document. It must be the value returned by a previous call\n  /// to \\ref createRule.\n  void appendResult(const SarifResult &SarifResult);\n\n  /// Return the SARIF document in its current state.\n  /// Calling this will trigger a copy of the internal state including all\n  /// reported diagnostics, resulting in an expensive call.\n  llvm::json::Object createDocument();\n\nprivate:\n  /// Source Manager to use for the current SARIF document.\n  const SourceManager &SourceMgr;\n\n  /// Flag to track the state of this document:\n  /// A closed document is one on which a new runs must be created.\n  /// This could be a document that is freshly created, or has recently\n  /// finished writing to a previous run.\n  bool Closed = true;\n\n  /// A sequence of SARIF runs.\n  /// Each run object describes a single run of an analysis tool and contains\n  /// the output of that run.\n  ///\n  /// Reference: <a href=\"https://docs.oasis-open.org/sarif/sarif/v2.1.0/os/sarif-v2.1.0-os.html#_Toc34317484\">run object</a>\n  llvm::json::Array Runs;\n\n  /// The list of rules associated with the most recent active run. These are\n  /// defined using the diagnostics passed to the SarifDocument. Each rule\n  /// need not be unique through the result set. E.g. there may be several\n  /// 'syntax' errors throughout code under analysis, each of which has its\n  /// own specific diagnostic message (and consequently, RuleId). Rules are\n  /// also known as \"reportingDescriptor\" objects in SARIF.\n  ///\n  /// Reference: <a href=\"https://docs.oasis-open.org/sarif/sarif/v2.1.0/os/sarif-v2.1.0-os.html#_Toc34317556\">rules property</a>\n  llvm::SmallVector<SarifRule, 32> CurrentRules;\n\n  /// The list of artifacts that have been encountered on the most recent active\n  /// run. An artifact is defined in SARIF as a sequence of bytes addressable\n  /// by a URI. A common example for clang's case would be files named by\n  /// filesystem paths.\n  llvm::StringMap<detail::SarifArtifact> CurrentArtifacts;\n}\n}\n\n} // extern \"C\"\n",
  "id": "BLOCK-CPP-16809",
  "language": "c++",
  "source_file": "/storage/emulated/0/Download/cpp_codebases/llvm/clang/include/clang/Basic/Sarif.h",
  "source_line": 380,
  "validation_status": "validated"
}
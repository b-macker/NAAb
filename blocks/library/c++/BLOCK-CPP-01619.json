{
  "code": "{\nABSL_NAMESPACE_BEGIN\n\nnamespace {\n\nconst crc_internal::CRC* CrcEngine() {\n  static const crc_internal::CRC* engine = crc_internal::CRC::Crc32c();\n  return engine;\n}\n\nconstexpr uint32_t kCRC32Xor = 0xffffffffU;\n\n}  // namespace\n\nnamespace crc_internal {\n\ncrc32c_t UnextendCrc32cByZeroes(crc32c_t initial_crc, size_t length) {\n  uint32_t crc = static_cast<uint32_t>(initial_crc) ^ kCRC32Xor;\n  CrcEngine()->UnextendByZeroes(&crc, length);\n  return static_cast<crc32c_t>(crc ^ kCRC32Xor);\n}\n\n// Called by `absl::ExtendCrc32c()` on strings with size > 64 or when hardware\n// CRC32C support is missing.\ncrc32c_t ExtendCrc32cInternal(crc32c_t initial_crc,\n                              absl::string_view buf_to_add) {\n  uint32_t crc = static_cast<uint32_t>(initial_crc) ^ kCRC32Xor;\n  CrcEngine()->Extend(&crc, buf_to_add.data(), buf_to_add.size());\n  return static_cast<crc32c_t>(crc ^ kCRC32Xor);\n}\n\n}  // namespace crc_internal\n\ncrc32c_t ComputeCrc32c(absl::string_view buf) {\n  return ExtendCrc32c(crc32c_t{0}, buf);\n}\n\ncrc32c_t ExtendCrc32cByZeroes(crc32c_t initial_crc, size_t length) {\n  uint32_t crc = static_cast<uint32_t>(initial_crc) ^ kCRC32Xor;\n  CrcEngine()->ExtendByZeroes(&crc, length);\n  return static_cast<crc32c_t>(crc ^ kCRC32Xor);\n}\n\ncrc32c_t ConcatCrc32c(crc32c_t lhs_crc, crc32c_t rhs_crc, size_t rhs_len) {\n  uint32_t result = static_cast<uint32_t>(lhs_crc);\n  CrcEngine()->ExtendByZeroes(&result, rhs_len);\n  return crc32c_t{result ^ static_cast<uint32_t>(rhs_crc)};\n}\n\ncrc32c_t RemoveCrc32cPrefix(crc32c_t crc_a, crc32c_t crc_ab, size_t length_b) {\n  return ConcatCrc32c(crc_a, crc_ab, length_b);\n}\n\ncrc32c_t MemcpyCrc32c(void* dest, const void* src, size_t count,\n                      crc32c_t initial_crc) {\n  return static_cast<crc32c_t>(\n      crc_internal::Crc32CAndCopy(dest, src, count, initial_crc, false));\n}\n\n// Remove a Suffix of given size from a buffer\n//\n// Given a CRC32C of an existing buffer, `full_string_crc`; the CRC32C of a\n// suffix of that buffer to remove, `suffix_crc`; and suffix buffer's length,\n// `suffix_len` return the CRC32C of the buffer with suffix removed\n//\n// This operation has a runtime cost of O(log(`suffix_len`))\ncrc32c_t RemoveCrc32cSuffix(crc32c_t full_string_crc, crc32c_t suffix_crc,\n                            size_t suffix_len) {\n  uint32_t result = static_cast<uint32_t>(full_string_crc) ^\n                    static_cast<uint32_t>(suffix_crc);\n  CrcEngine()->UnextendByZeroes(&result, suffix_len);\n  return crc32c_t{result};\n}\n\nABSL_NAMESPACE_END\n}",
  "id": "BLOCK-CPP-01619",
  "language": "c++",
  "source_file": "/storage/emulated/0/Download/cpp_codebases/abseil/absl/crc/crc32c.cc",
  "source_line": 24,
  "validation_status": "validated"
}
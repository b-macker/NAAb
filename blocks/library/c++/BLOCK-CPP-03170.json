{
  "code": "{\n public:\n  Vec() { Init(); }\n  ~Vec() { Discard(); }\n\n  void clear() {\n    Discard();\n    Init();\n  }\n\n  bool empty() const { return size_ == 0; }\n  uint32_t size() const { return size_; }\n  T* begin() { return ptr_; }\n  T* end() { return ptr_ + size_; }\n  const T& operator[](uint32_t i) const { return ptr_[i]; }\n  T& operator[](uint32_t i) { return ptr_[i]; }\n  const T& back() const { return ptr_[size_-1]; }\n  void pop_back() { size_--; }\n\n  void push_back(const T& v) {\n    if (size_ == capacity_) Grow(size_ + 1);\n    ptr_[size_] = v;\n    size_++;\n  }\n\n  void resize(uint32_t n) {\n    if (n > capacity_) Grow(n);\n    size_ = n;\n  }\n\n  void fill(const T& val) {\n    for (uint32_t i = 0; i < size(); i++) {\n      ptr_[i] = val;\n    }\n  }\n\n  // Guarantees src is empty at end.\n  // Provided for the hash table resizing code below.\n  void MoveFrom(Vec<T>* src) {\n    if (src->ptr_ == src->space_) {\n      // Need to actually copy\n      resize(src->size_);\n      std::copy_n(src->ptr_, src->size_, ptr_);\n      src->size_ = 0;\n    } else {\n      Discard();\n      ptr_ = src->ptr_;\n      size_ = src->size_;\n      capacity_ = src->capacity_;\n      src->Init();\n    }\n  }\n\n private:\n  T* ptr_;\n  T space_[kInline];\n  uint32_t size_;\n  uint32_t capacity_;\n\n  void Init() {\n    ptr_ = space_;\n    size_ = 0;\n    capacity_ = kInline;\n  }\n\n  void Discard() {\n    if (ptr_ != space_) base_internal::LowLevelAlloc::Free(ptr_);\n  }\n\n  void Grow(uint32_t n) {\n    while (capacity_ < n) {\n      capacity_ *= 2;\n    }\n    size_t request = static_cast<size_t>(capacity_) * sizeof(T);\n    T* copy = static_cast<T*>(\n        base_internal::LowLevelAlloc::AllocWithArena(request, arena));\n    std::copy_n(ptr_, size_, copy);\n    Discard();\n    ptr_ = copy;\n  }\n\n  Vec(const Vec&) = delete;\n  Vec& operator=(const Vec&) = delete;\n}",
  "id": "BLOCK-CPP-03170",
  "language": "c++",
  "source_file": "/storage/emulated/0/Download/cpp_codebases/abseil/absl/synchronization/internal/graphcycles.cc",
  "source_line": 75,
  "validation_status": "validated"
}
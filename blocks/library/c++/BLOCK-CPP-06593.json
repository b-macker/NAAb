{
  "code": "{\n\n// Returns (v * f + a) but avoiding intermediate overflow when possible.\nCONSTEXPR_F diff_t scale_add(diff_t v, diff_t f, diff_t a) noexcept {\n  return (v < 0) ? ((v + 1) * f + a) - f : ((v - 1) * f + a) + f;\n}\n\n// Map a (normalized) Y/M/D to the number of days before/after 1970-01-01.\n// Probably overflows for years outside [-292277022656:292277026595].\nCONSTEXPR_F diff_t ymd_ord(year_t y, month_t m, day_t d) noexcept {\n  const diff_t eyear = (m <= 2) ? y - 1 : y;\n  const diff_t era = (eyear >= 0 ? eyear : eyear - 399) / 400;\n  const diff_t yoe = eyear - era * 400;\n  const diff_t doy = (153 * (m + (m > 2 ? -3 : 9)) + 2) / 5 + d - 1;\n  const diff_t doe = yoe * 365 + yoe / 4 - yoe / 100 + doy;\n  return era * 146097 + doe - 719468;\n}\n\n// Returns the difference in days between two normalized Y-M-D tuples.\n// ymd_ord() will encounter integer overflow given extreme year values,\n// yet the difference between two such extreme values may actually be\n// small, so we take a little care to avoid overflow when possible by\n// exploiting the 146097-day cycle.\nCONSTEXPR_F diff_t day_difference(year_t y1, month_t m1, day_t d1, year_t y2,\n                                  month_t m2, day_t d2) noexcept {\n  const diff_t a_c4_off = y1 % 400;\n  const diff_t b_c4_off = y2 % 400;\n  diff_t c4_diff = (y1 - a_c4_off) - (y2 - b_c4_off);\n  diff_t delta = ymd_ord(a_c4_off, m1, d1) - ymd_ord(b_c4_off, m2, d2);\n  if (c4_diff > 0 && delta < 0) {\n    delta += 2 * 146097;\n    c4_diff -= 2 * 400;\n  } else if (c4_diff < 0 && delta > 0) {\n    delta -= 2 * 146097;\n    c4_diff += 2 * 400;\n  }\n  return (c4_diff / 400 * 146097) + delta;\n}\n\n}",
  "id": "BLOCK-CPP-06593",
  "language": "c++",
  "source_file": "/storage/emulated/0/Download/cpp_codebases/abseil/absl/time/internal/cctz/include/cctz/civil_time_detail.h",
  "source_line": 261,
  "validation_status": "validated"
}
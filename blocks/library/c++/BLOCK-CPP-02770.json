{
  "code": "#include \"absl/random/internal/chi_square.h\"\n#include <cmath>\n#include \"absl/random/internal/distribution_test_util.h\"\n\nusing namespace absl;\nusing namespace random_internal;\n\nextern \"C\" {\n\nvoid BLOCK-CPP-02770_execute() {\n    {\n  static constexpr double kChiEpsilon =\n      0.000001;  // Accuracy of the approximation.\n  static constexpr double kChiMax =\n      99999.0;  // Maximum chi-squared value.\n\n  const double p_value = 1.0 - p;\n  if (dof < 1 || p_value > 1.0) {\n    return 0.0;\n  }\n\n  if (dof > kLargeDOF) {\n    // For large degrees of freedom, use the normal approximation by\n    //     Wilson, E. B. and Hilferty, M. M. (1931)\n    //                     chi^2 - mean\n    //                Z = --------------\n    //                        stddev\n    const double z = InverseNormalSurvival(p_value);\n    const double mean = 1 - 2.0 / (9 * dof);\n    const double variance = 2.0 / (9 * dof);\n    // Cannot use this method if the variance is 0.\n    if (variance != 0) {\n      double term = z * std::sqrt(variance) + mean;\n      return dof * (term * term * term);\n    }\n  }\n\n  if (p_value <= 0.0) return kChiMax;\n\n  // Otherwise search for the p value by bisection\n  double min_chisq = 0.0;\n  double max_chisq = kChiMax;\n  double current = dof / std::sqrt(p_value);\n  while ((max_chisq - min_chisq) > kChiEpsilon) {\n    if (ChiSquarePValue(current, dof) < p_value) {\n      max_chisq = current;\n    } else {\n      min_chisq = current;\n    }\n    current = (max_chisq + min_chisq) * 0.5;\n  }\n  return current;\n}\n}\n\n} // extern \"C\"\n",
  "id": "BLOCK-CPP-02770",
  "language": "c++",
  "source_file": "/storage/emulated/0/Download/cpp_codebases/abseil/absl/random/internal/chi_square.cc",
  "source_line": 106,
  "validation_status": "validated"
}
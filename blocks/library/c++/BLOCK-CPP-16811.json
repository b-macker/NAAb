{
  "code": "{\n\n/// \\internal\n/// An artifact location is SARIF's way of describing the complete location\n/// of an artifact encountered during analysis. The \\c artifactLocation object\n/// typically consists of a URI, and/or an index to reference the artifact it\n/// locates.\n///\n/// This builder makes an additional assumption: that every artifact encountered\n/// by \\c clang will be a physical, top-level artifact. Which is why the static\n/// creation method \\ref SarifArtifactLocation::create takes a mandatory URI\n/// parameter. The official standard states that either a \\c URI or \\c Index\n/// must be available in the object, \\c clang picks the \\c URI as a reasonable\n/// default, because it intends to deal in physical artifacts for now.\n///\n/// Reference:\n/// 1. <a href=\"https://docs.oasis-open.org/sarif/sarif/v2.1.0/os/sarif-v2.1.0-os.html#_Toc34317427\">artifactLocation object</a>\n/// 2. \\ref SarifArtifact\nclass SarifArtifactLocation {\nprivate:\n  friend class clang::SarifDocumentWriter;\n\n  std::optional<uint32_t> Index;\n  std::string URI;\n\n  SarifArtifactLocation() = delete;\n  explicit SarifArtifactLocation(const std::string &URI) : URI(URI) {}\n\npublic:\n  static SarifArtifactLocation create(llvm::StringRef URI) {\n    return SarifArtifactLocation{URI.str()};\n  }\n\n  SarifArtifactLocation setIndex(uint32_t Idx) {\n    Index = Idx;\n    return *this;\n  }\n};\n\n/// \\internal\n/// An artifact in SARIF is any object (a sequence of bytes) addressable by\n/// a URI (RFC 3986). The most common type of artifact for clang's use-case\n/// would be source files. SARIF's artifact object is described in detail in\n/// section 3.24.\n//\n/// Since every clang artifact MUST have a location (there being no nested\n/// artifacts), the creation method \\ref SarifArtifact::create requires a\n/// \\ref SarifArtifactLocation object.\n///\n/// Reference:\n/// 1. <a href=\"https://docs.oasis-open.org/sarif/sarif/v2.1.0/os/sarif-v2.1.0-os.html#_Toc34317611\">artifact object</a>\nclass SarifArtifact {\nprivate:\n  friend class clang::SarifDocumentWriter;\n\n  std::optional<uint32_t> Offset;\n  std::optional<size_t> Length;\n  std::string MimeType;\n  SarifArtifactLocation Location;\n  llvm::SmallVector<std::string, 4> Roles;\n\n  SarifArtifact() = delete;\n\n  explicit SarifArtifact(const SarifArtifactLocation &Loc) : Location(Loc) {}\n\npublic:\n  static SarifArtifact create(const SarifArtifactLocation &Loc) {\n    return SarifArtifact{Loc};\n  }\n\n  SarifArtifact setOffset(uint32_t ArtifactOffset) {\n    Offset = ArtifactOffset;\n    return *this;\n  }\n\n  SarifArtifact setLength(size_t NumBytes) {\n    Length = NumBytes;\n    return *this;\n  }\n\n  SarifArtifact setRoles(std::initializer_list<llvm::StringRef> ArtifactRoles) {\n    Roles.assign(ArtifactRoles.begin(), ArtifactRoles.end());\n    return *this;\n  }\n\n  SarifArtifact setMimeType(llvm::StringRef ArtifactMimeType) {\n    MimeType = ArtifactMimeType.str();\n    return *this;\n  }\n};\n\n}",
  "id": "BLOCK-CPP-16811",
  "language": "c++",
  "source_file": "/storage/emulated/0/Download/cpp_codebases/llvm/clang/include/clang/Basic/Sarif.h",
  "source_line": 53,
  "validation_status": "validated"
}
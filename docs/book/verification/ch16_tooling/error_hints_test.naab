// Verification Test: Enhanced error messages with hints
// This file demonstrates various error scenarios that trigger helpful hints
// Note: Some examples are commented out as they would cause parse errors

use io

// Example 1: Correct dictionary usage (quoted keys)
fn correctDictExample() {
    let person = {
        "name": "Alice",
        "age": 30,
        "role": "Engineer"
    }
    io.write("Name: " + person["name"])
}

// Example 2: Using structs for fixed schemas (better than dicts)
struct Employee {
    name: string,
    age: int,
    role: string
}

fn structExample() {
    let employee = Employee {
        name: "Bob",
        age: 25,
        role: "Designer"
    }
    io.write("Employee: " + employee.name)  // ✅ Dot notation works on structs
}

// Example 3: Proper error handling (not empty)
fn goodErrorHandling() {
    try {
        riskyOperation()
    } catch (error) {
        io.write("Error occurred: " + error)  // ✅ Proper error handling
        // Could also re-throw: throw error
    }
}

// Example 4: Null checking before access
fn safeNullHandling(value: int?) -> int {
    if value != null {
        return value * 2  // ✅ Safe access after null check
    }
    return 0
}

// Example 5: Correct polyglot block syntax
fn correctPolyglotBlock() {
    let data = [1, 2, 3, 4, 5]

    // ✅ Correct: Variables passed in brackets
    let mean = <<python[data]
import statistics
statistics.mean(data)
    >>

    io.write("Mean: " + toString(mean))
}

// Example 6: Using 'use' for imports (not 'import')
// ✅ Correct: use io
// ❌ Wrong: import io from "std"

// Example 7: Variable naming (avoiding typos)
fn demonstrateTypoDetection() {
    let configuration = {
        "timeout": 30,
        "retry": 3,
        "debug": true
    }

    // If you accidentally type 'config' instead of 'configuration',
    // the error message will suggest: "Did you mean 'configuration'?"
    io.write("Config: " + toString(configuration["timeout"]))
}

// Dummy function
fn riskyOperation() {
    throw "Simulated error"
}

main {
    io.write("Enhanced Error Messages Test")
    io.write("============================")
    io.write("")

    io.write("✅ Correct dictionary with quoted keys")
    correctDictExample()

    io.write("\n✅ Using structs for fixed schemas")
    structExample()

    io.write("\n✅ Proper error handling")
    try {
        goodErrorHandling()
    } catch (e) {
        io.write("Caught: " + e)
    }

    io.write("\n✅ Safe null handling")
    let result = safeNullHandling(42)
    io.write("Result: " + toString(result))

    io.write("\n✅ Correct polyglot block syntax")
    correctPolyglotBlock()

    io.write("\n✅ Proper variable naming")
    demonstrateTypoDetection()

    io.write("\nAll examples use correct patterns!")
    io.write("Try introducing errors to see helpful hints:")
    io.write("  - Remove quotes from dict keys")
    io.write("  - Use 'import' instead of 'use'")
    io.write("  - Forget variable list in polyglot block")
    io.write("  - Make typos in variable names")
}

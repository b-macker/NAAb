# Chapter 9: System Interaction Verification

use io as io
use file as fs
use time as time
use env as env

main {
    print(">>> Chapter 9 Verification: System Interaction <<<")

    # 1. IO/Print
    print("--- Basic Output ---")
    print("Printing works.")
    
    # ISS-010 Fixed: Console I/O works
    io.write("IO Write Test")
    io.write("\n")

    # 2. File Module
    print("--- File Module ---")
    let test_file = "ch09_test_file.txt"
    let content = "Hello File System"
    
    fs.write(test_file, content)
    print("File written.")
    
    if fs.exists(test_file) {
        print("File exists check passed.")
        let read = fs.read(test_file)
        print("Read content:", read)
        
        fs.append(test_file, " Appended")
        let read_appended = fs.read(test_file)
        print("Appended content:", read_appended)
        
        fs.delete(test_file)
        if !fs.exists(test_file) {
            print("File deletion check passed.")
        }
    } else {
        print("FAIL: File was not created.")
    }

    # 3. Time Module
    print("--- Time Module ---")
    let now = time.now()
    print("Timestamp:", now)
    
    let start_ms = time.now_millis()
    time.sleep(0.1)
    let end_ms = time.now_millis()
    print("Sleep duration (~100ms):", end_ms - start_ms)
    
    let fmt = time.format_timestamp(now, "%Y-%m-%d")
    print("Formatted date:", fmt)
    print("Year:", time.year(now))

    # 4. Env Module
    print("--- Env Module ---")
    env.set_var("NAAB_TEST_VAR", "verification_value")
    let val = env.get("NAAB_TEST_VAR")
    print("Env var value:", val) # Expected: verification_value

    print(">>> Chapter 9 Verification: COMPLETE <<<")
}
// Final test for JavaScript array/object type conversion (Bug #3)

main {
    print("Testing JavaScript Array/Object Conversion Fix")
    print()

    // Test 1: Empty array
    print("Test 1: Empty array")
    let empty = <<javascript
[]
    >>
    print("  Type:", type(empty))
    if type(empty) == "array" {
        print("  ✓ PASS - Returns array type")
    }

    // Test 2: Single element array
    print("Test 2: Single element array")
    let single = <<javascript
[42]
    >>
    print("  Type:", type(single))
    print("  Value:", single[0])
    if single[0] == 42 {
        print("  ✓ PASS - Element accessible")
    }

    // Test 3: Multiple elements
    print("Test 3: Multiple elements")
    let multi = <<javascript
[1, 2, 3, 4, 5]
    >>
    print("  Type:", type(multi))
    print("  First:", multi[0])
    print("  Last:", multi[4])
    if multi[0] == 1 {
        if multi[4] == 5 {
            print("  ✓ PASS - All elements accessible")
        }
    }

    // Test 4: Nested arrays
    print("Test 4: Nested arrays")
    let nested = <<javascript
[[1, 2], [3, 4]]
    >>
    print("  Type:", type(nested))
    print("  Nested value:", nested[0][1])
    if nested[0][1] == 2 {
        print("  ✓ PASS - Nested arrays work")
    }

    // Test 5: Empty object
    print("Test 5: Empty object")
    let empty_obj = <<javascript
({})
    >>
    print("  Type:", type(empty_obj))
    if type(empty_obj) == "dict" {
        print("  ✓ PASS - Returns dict type")
    }

    // Test 6: Object with properties
    print("Test 6: Object with properties")
    let obj = <<javascript
({name: "Alice", age: 30})
    >>
    print("  Type:", type(obj))
    print("  Name:", obj["name"])
    print("  Age:", obj["age"])
    if obj["name"] == "Alice" {
        if obj["age"] == 30 {
            print("  ✓ PASS - Properties accessible")
        }
    }

    // Test 7: Nested object
    print("Test 7: Nested object")
    let nested_obj = <<javascript
({user: {name: "Bob"}, score: 95})
    >>
    print("  Type:", type(nested_obj))
    print("  User name:", nested_obj["user"]["name"])
    if nested_obj["user"]["name"] == "Bob" {
        print("  ✓ PASS - Nested objects work")
    }

    // Test 8: Array of objects
    print("Test 8: Array of objects")
    let arr_objs = <<javascript
[{id: 1}, {id: 2}]
    >>
    print("  Type:", type(arr_objs))
    print("  First ID:", arr_objs[0]["id"])
    if arr_objs[0]["id"] == 1 {
        print("  ✓ PASS - Array of objects works")
    }

    print()
    print("All critical tests completed!")
    print("Bug #3 JavaScript array/object conversion is FIXED! ✓")
}

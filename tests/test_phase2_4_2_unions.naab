// Phase 2.4.2: Union Types
// Test file to verify union type declarations and usage

// Test 1: Function with union parameter type
function printValue(value: int | string) {
    print("Value: " + value)
}

// Test 2: Function with union return type
function getValue(flag: bool) -> int | string {
    if (flag) {
        return 42
    } else {
        return "hello"
    }
}

// Test 3: Nullable union (equivalent to Option<T>)
function findUser(id: int) -> string | null {
    if (id == 1) {
        return "Alice"
    }
    return null
}

// Test 4: Multi-type union
function parseValue(input: string) -> int | float | bool | string {
    // Simplified parsing logic
    if (input == "true" || input == "false") {
        return input == "true"
    }
    return input
}

// Test 5: Struct with union field
struct Config {
    port: int | string
    debug: bool
}

// Test 6: Union with complex types
function processData(data: list<int> | dict<string, int>) -> int {
    // Simplified processing
    return 0
}

main {
    print("=== Phase 2.4.2: Testing Union Types ===\n")

    // Test 1: Union parameter
    print("\n[Test 1] Union parameters:")
    printValue(42)
    printValue("test")

    // Test 2: Union return values
    print("\n[Test 2] Union return types:")
    let val1 = getValue(true)
    print("getValue(true): " + val1)
    let val2 = getValue(false)
    print("getValue(false): " + val2)

    // Test 3: Nullable unions
    print("\n[Test 3] Nullable unions (string | null):")
    let user1 = findUser(1)
    print("findUser(1): " + user1)
    let user2 = findUser(999)
    if (user2 == null) {
        print("findUser(999): null")
    }

    // Test 4: Multi-type unions
    print("\n[Test 4] Multi-type unions:")
    let parsed1 = parseValue("true")
    print("parseValue('true'): " + parsed1)
    let parsed2 = parseValue("hello")
    print("parseValue('hello'): " + parsed2)

    // Test 5: Struct with union fields
    print("\n[Test 5] Struct with union field:")
    let config1 = Config {
        port: 8080,
        debug: true
    }
    print("Config with int port: " + config1.port)

    let config2 = Config {
        port: "8080",
        debug: false
    }
    print("Config with string port: " + config2.port)

    // Test 6: Type checking at runtime
    print("\n[Test 6] Runtime type checking:")
    let mixed_value = getValue(true)
    if (typeof(mixed_value) == "int") {
        print("mixed_value is int: " + mixed_value)
    } else {
        print("mixed_value is string: " + mixed_value)
    }

    // Test 7: Union in variable declarations
    print("\n[Test 7] Variable with union type:")
    let flexible: int | string = 42
    print("flexible = " + flexible)
    flexible = "changed to string"
    print("flexible = " + flexible)

    print("\n\n=== Phase 2.4.2: All tests completed ===")
}

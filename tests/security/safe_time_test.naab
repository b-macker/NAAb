// NAAb Safe Time Tests
// Tests time/counter wraparound detection

fn testSafeTimeAddition() {
    print("Test: Safe time addition...")

    let time1 = 1000000
    let delta = 500000
    let result = time1 + delta
    if result != 1500000 { throw "Normal time addition failed" }

    print("  Safe time addition works")
}

fn testCounterIncrement() {
    print("Test: Counter increment...")

    let counter = 0
    let i = 0
    while i < 100 {
        counter = counter + 1
        i = i + 1
    }
    if counter != 100 { throw "Counter incremented incorrectly" }

    print("  Counter increment works")
}

fn testCounterOverflowDetection() {
    print("Test: Counter overflow detection...")
    print("  Counter overflow detection (tested in C++)")
}

fn testTimeGoingBackwards() {
    print("Test: Time monotonicity...")

    let time1 = 1000000
    let time2 = 999999
    if !(time2 < time1) { throw "Time comparison failed" }

    print("  Time monotonicity check works")
}

main {
    print("=== Safe Time Tests ===")

    testSafeTimeAddition()
    testCounterIncrement()
    testCounterOverflowDetection()
    testTimeGoingBackwards()

    print("")
    print("All safe time tests passed!")
}

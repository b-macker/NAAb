// Debugger watch expression test
// Run with: naab-lang run --debug watch_test.naab

use io

fn fibonacci(n: int) -> int {
    if n <= 1 {
        return n
    }

    let a = 0
    let b = 1
    let i = 2

    while i <= n {
        let temp = a + b  // Watch: temp, a, b, i
        a = b
        b = temp
        i = i + 1
    }

    return b
}

fn factorial(n: int) -> int {
    if n <= 1 {
        return 1
    }

    let result = 1
    let i = 2

    while i <= n {
        result = result * i  // Watch: result, i
        i = i + 1
    }

    return result
}

main {
    io.write("=== Watch Expression Test ===\n")

    // Test watch expressions with:
    // w temp    - Add watch for 'temp'
    // w a       - Add watch for 'a'
    // w b       - Add watch for 'b'
    // w         - List all watches

    io.write("Fibonacci(10): ")
    let fib = fibonacci(10)
    io.write(fib)
    io.write("\n")

    io.write("Factorial(5): ")
    let fact = factorial(5)
    io.write(fact)
    io.write("\n")

    io.write("=== Test Complete ===\n")
}

// Expected watch values during fibonacci(10):
// Loop 1: temp=1, a=0, b=1, i=2
// Loop 2: temp=1, a=1, b=1, i=3
// Loop 3: temp=2, a=1, b=2, i=4
// Loop 4: temp=3, a=2, b=3, i=5
// ... and so on
